---
title: "Nginxとは"
label: "Nginxとは"
---

# `Nginx`とは

`Nginx`（エンジンエックス）は、`Web`サーバーやリバースプロキシ、ロードバランサー、`HTTP`キャッシュなどとして幅広く使われるオープンソースのソフトウェアです。特に、高いパフォーマンスと低メモリ消費で知られ、アクセスが集中する大規模な`Web`サイトでよく採用されています。

## `Nginx`の主な機能と役割

`Nginx`は、その柔軟な設計によって様々な役割をこなすことができます。

1. **`Web`サーバー**
   - `Nginx`の最も基本的な役割は、`Web`サーバーです。`HTML`ファイルや画像などの静的コンテンツを高速に配信できます。`Apache HTTP Server`と並んで、最も広く利用されている`Web`サーバーの一つです。`Nginx`は、大量の同時接続を効率的に処理するイベント駆動型のアーキテクチャを採用しており、高負荷時でも安定して動作します。

2. **リバースプロキシ**
   - `Nginx`は、クライアントからのリクエストを、内部ネットワークにある実際の`Web`サーバー（アプリケーションサーバー）に転送するリバースプロキシとしてよく使われます。これにより、クライアントは`Nginx`のアドレスにアクセスするだけで済み、内部サーバーの存在を隠すことができます。これはセキュリティの向上に役立ちます。また、クライアントとアプリケーションサーバー間の通信を`Nginx`が中継するため、`SSL/TLS`の終端処理を`Nginx`に任せることができ、アプリケーションサーバー側の負荷を軽減できます。

3. **ロードバランサー**
   - 複数のアプリケーションサーバーが稼働している場合、`Nginx`はそれらのサーバーにリクエストを分散するロードバランサーとして機能します。これにより、特定のサーバーにアクセスが集中するのを防ぎ、システム全体の可用性とパフォーマンスを向上させます。`Nginx`は、ラウンドロビン、`IP`ハッシュ、重み付けなどの様々な負荷分散アルゴリズムをサポートしています。

4. **`HTTP`キャッシュ**
   - `Nginx`は、リバースプロキシとして動作する際に、頻繁にアクセスされるコンテンツをキャッシュする`HTTP`キャッシュとしても使えます。これにより、同じコンテンツへのリクエストがあった場合、アプリケーションサーバーにアクセスすることなく、`Nginx`が直接応答を返せるため、応答速度を大幅に向上させ、バックエンドサーバーの負荷を軽減します。

## 設定ファイルの基本構造

`Nginx`の設定は、テキストファイル（通常は`nginx.conf`）で行います。設定ファイルは、ディレクティブとブロックで構成されており、階層的な構造になっています。

- **ディレクティブ**: 設定の最小単位で、セミコロン（`;`）で終わります。
- **ブロック**: 関連するディレクティブをまとめる括弧（`{}`）で囲まれたセクションです。

### 簡単な設定例:

```nginx
user nginx;
worker_processes auto;

http {
    server {
        listen 80;
        server_name example.com;

        location / {
            root /var/www/html;
            index index.html;
        }
    }
}
```

この例では、`http`ブロック内に`server`ブロックがあり、さらにその中に`location`ブロックがあります。

- **`http`**: `Web`トラフィック全体の設定を定義します。
- **`server`**: 特定のドメイン（`server_name`）やポート（`listen`）での動作を定義します。
- **`location`**: 特定の`URL`パス（`/`など）に対するリクエストの処理方法を定義します。

## `Nginx`と`Apache HTTP Server`の比較

`Nginx`は`Apache`よりも後発の`Web`サーバーであり、設計思想が異なります。

| 特徴 | `Nginx` | `Apache HTTP Server` |
| --- | --- | --- |
| アーキテクチャ | イベント駆動型 | プロセス/スレッドベース |
| 同時接続処理 | 高い（低メモリ消費） | 比較的低い（高メモリ消費） |
| 静的コンテンツ | 高速配信に特化 | `Nginx`より遅い傾向 |
| 動的コンテンツ | リバースプロキシ経由で処理 | サーバー自身が処理可能 |
| 設定の柔軟性 | 比較的シンプル | 非常に柔軟（`.htaccess`など） |

`Nginx`のイベント駆動型アーキテクチャは、少数のワーカープロセスで多数の接続を効率的に処理できるため、大量の同時アクセスがある環境で特に優位性があります。

## `Nginx`を使用するメリット

`Nginx`は単なる高速な`Web`サーバー以上の存在であり、その設計思想と機能によって多くのメリットをもたらします。

1. **高いパフォーマンスとスケーラビリティ** 📈
   - `Nginx`の最大の強みは、そのイベント駆動型アーキテクチャにあります。`Apache`のようなプロセス/スレッドベースのサーバーは、クライアントからの接続ごとに新しいプロセスやスレッドを生成するため、アクセスが増えるとメモリ消費が増大し、性能が低下します。一方、`Nginx`は少数のワーカープロセスで、多数の同時接続を非同期かつ効率的に処理します。これにより、メモリ消費を低く抑えつつ、大量のリクエストを高速に捌くことができます。これは、特にアクセスが集中する大規模サイトや`API`サーバーにとって大きなメリットとなります。

2. **リバースプロキシとしての利点** 🛡️
   - `Nginx`をリバースプロキシとして使用することで、複数のメリットが得られます。
     - **セキュリティの向上**: 内部にあるアプリケーションサーバーを直接インターネットに公開せず、`Nginx`が外部からのアクセスをすべて受け付けます。これにより、内部サーバーの`IP`アドレスや構成を隠蔽し、攻撃対象を減らすことができます。
     - **`SSL/TLS`終端処理**: `SSL/TLS`通信の暗号化・復号化は`CPU`に大きな負荷をかけます。`Nginx`がリバースプロキシとしてこの処理（`SSL/TLS`終端処理）を一手に引き受けることで、アプリケーションサーバーは暗号化の負担から解放され、本来の処理に集中できます。
     - **柔軟なルーティング**: `Nginx`は、リクエストの`URL`やヘッダー情報に基づいて、異なるアプリケーションサーバーにトラフィックを振り分けることができます。これにより、マイクロサービスアーキテクチャのような複雑なシステム構成でも、効率的なトラフィック管理が可能になります。

3. **ロードバランサーとしての優位性** ⚖️
   - `Nginx`のロードバランシング機能は、システム全体の可用性とパフォーマンスを飛躍的に向上させます。
     - **負荷分散アルゴリズム**: 単純に順番にリクエストを振り分ける「ラウンドロビン」から、サーバーの重み付けを考慮した「重み付けラウンドロビン」、クライアントの`IP`アドレスに基づいた「`IP`ハッシュ」まで、多様なアルゴリズムをサポートしています。これにより、システムの要件に合わせて最適な負荷分散戦略を選択できます。
     - **障害耐性の向上**: 特定のサーバーがダウンした場合、`Nginx`は自動的にそのサーバーへのトラフィック送信を停止し、残りの正常なサーバーにリクエストを振り分け続けます。これにより、サービス全体が停止するのを防ぐことができます。

4. **高速な静的コンテンツ配信** 🖼️
   - `Nginx`は静的コンテンツ（`HTML`、`CSS`、`JavaScript`、画像など）の配信に特化しています。リクエストが来た際に、ディスクから直接ファイルを読み込んで高速にクライアントに返送するよう最適化されています。
     - **`HTTP`キャッシュの活用**: `Nginx`の`HTTP`キャッシュ機能は、静的コンテンツ配信をさらに高速化します。一度アクセスされたコンテンツをメモリやディスクに保存することで、同じリクエストが再度来た際にはアプリケーションサーバーに問い合わせることなく、`Nginx`が直接応答を返します。これにより、バックエンドサーバーの負荷を劇的に軽減し、クライアントへの応答時間を短縮します。