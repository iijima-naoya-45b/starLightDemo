---
title: "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ"
label: "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ"
---

## ğŸ”„ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆï¼šãƒ‡ãƒ¼ã‚¿ã®å‹ç®¡ç†ã¨ç”»é¢æ¥ç¶šã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

ã€ŒAPIæˆ¦ç•¥ã€ã®ã•ã‚‰ã«æ·±ã„ã¨ã“ã‚ã€ã¤ã¾ã‚Š**ã€Œãƒ‡ãƒ¼ã‚¿ã®å‹ã‚’ã©ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã€èª°ãŒã€ã©ã†ç®¡ç†ã—ã€ã©ã†ç”»é¢ã«æ¥ç¶šã™ã‚‹ã‹ã€**ã¨ã„ã†ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è©±ã§ã™ã€‚

å®Ÿå‹™ã§ç ´ç¶»ã™ã‚‹åŸå› ã¯ã€APIã®å‹ãŒãã®ã¾ã¾UIã«æµã‚Œã¦ã—ã¾ã„ã€UIã®éƒ½åˆã§APIãŒå£Šã‚Œã‚‹ï¼ˆã‚ã‚‹ã„ã¯ãã®é€†ï¼‰ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚’é˜²ããŸã‚ã®**ã€Œ3ã¤ã®å±¤ã€ã¨ã€ŒRHFã®æ¥ç¶šæˆ¦ç•¥ã€**ã‚’è§£èª¬ã—ã¾ã™ã€‚

### ğŸš¨ ãƒã‚µã‚«ãƒªï¼šAPIã®å‹ãŒãã®ã¾ã¾UIã«æµã‚Œã¦ã—ã¾ã†

**âŒ æ‚ªã„ä¾‹: APIã®å‹ã‚’ãã®ã¾ã¾UIã§ä½¿ç”¨**

```typescript
// âŒ å•é¡Œ: APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹ã‚’ãã®ã¾ã¾UIã§ä½¿ç”¨
// APIå‘¼ã³å‡ºã—
const response = await fetch('https://api.example.com/users');
const data = await response.json(); // unknownå‹ã€å‹ãƒã‚§ãƒƒã‚¯ãªã—

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
function UserList() {
  const [users, setUsers] = useState<any[]>([]); // anyå‹ã§ä½¿ç”¨

  useEffect(() => {
    fetch('/api/users')
      .then(res => res.json())
      .then(data => setUsers(data)); // å‹ãƒã‚§ãƒƒã‚¯ãªã—
  }, []);

  return (
    <div>
      {users.map(user => (
        <div key={user.id}>
          {user.first_name} {user.last_name} {/* snake_caseãŒãã®ã¾ã¾UIã« */}
        </div>
      ))}
    </div>
  );
}
```

**å•é¡Œç‚¹:**
1. **å‹å®‰å…¨æ€§ãŒãªã„**: `any`å‹ã‚„å‹ãƒã‚§ãƒƒã‚¯ãªã—ã§ä½¿ç”¨
2. **APIå¤‰æ›´ã®å½±éŸ¿**: APIã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼ˆ`first_name`ãªã©ï¼‰ãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨ã€UIå…¨ä½“ãŒå£Šã‚Œã‚‹
3. **UIå¤‰æ›´ã®å½±éŸ¿**: UIã§ä½¿ã„ãŸã„å½¢å¼ï¼ˆ`fullName`ãªã©ï¼‰ã«å¤‰æ›´ã™ã‚‹ãŸã‚ã€APIã‚’å¤‰æ›´ã—ã¦ã—ã¾ã†
4. **ä¿å®ˆæ€§ã®ä½ä¸‹**: APIã¨UIãŒå¯†çµåˆã§ã€å¤‰æ›´ãŒå›°é›£

### âœ… æ­£è§£: 3ã¤ã®å±¤ã§è²¬å‹™ã‚’åˆ†é›¢

ãƒ‡ãƒ¼ã‚¿ã®å‹ç®¡ç†ã‚’3ã¤ã®å±¤ã«åˆ†ã‘ã‚‹ã“ã¨ã§ã€APIã¨UIã®è²¬å‹™ã‚’æ˜ç¢ºã«åˆ†é›¢ã§ãã¾ã™ã€‚

#### å‹å®šç¾©ã®3ã¤ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼

| å±¤ (Layer) | åç§° | å½¹å‰² | ç®¡ç†å ´æ‰€ |
|-----------|------|------|---------|
| **MSWå±¤** | Mock Service Worker | é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§APIã‚’ãƒ¢ãƒƒã‚¯ã™ã‚‹ã€‚ | `src/mocks/handlers.ts` |
| **Schemaå±¤** | API Schema | APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãã®ã‚‚ã®ã®å½¢ã€‚Zodã§å®šç¾©ã€‚ | `src/api/schema.ts` |
| **DTOå±¤** | Data Transfer Object | APIã®å‹ã‚’ã€ŒUIã§ä½¿ã„ã‚„ã™ã„å½¢ã€ã«å¤‰æ›ã—ãŸå‹ã€‚ | `src/types/user.ts` |
| **Formå±¤** | Form Schema | RHFã®`defaultValues`ã‚„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®å‹ã€‚ | `src/components/UserForm/schema.ts` |

> **æ³¨æ„**: MSWå±¤ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[MSWï¼ˆãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰](./05_MSW_ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼.mdx)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## 1. Schemaå±¤: APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å®šç¾©ï¼ˆZodã§æ´—æµ„ï¼‰

**å½¹å‰²**: APIã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€`unknown`å‹ã¨ã—ã¦å—ã‘å–ã‚Šã€Zodã§å‹ãƒã‚§ãƒƒã‚¯ã—ã¦å³å¯†ãªå‹ã«å¤‰æ›ã™ã‚‹ã€‚

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**: **å¿…ãš`unknown`ã§å–å¾—ã—ã¦ã‹ã‚‰Zodã§å‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹**ã€‚

### æ±ç”¨çš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰

```typescript
// src/api/utils/schemaUtils.ts
import { z } from 'zod';
import { ZodSchema } from 'zod';

/**
 * æ±ç”¨çš„ãªAPIå‘¼ã³å‡ºã—é–¢æ•°ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰
 * @param url - APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL
 * @param schema - Zodã‚¹ã‚­ãƒ¼ãƒï¼ˆå‹ãƒã‚§ãƒƒã‚¯ç”¨ï¼‰
 * @param options - fetchã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆmethod, headers, bodyãªã©ï¼‰
 * @returns å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿
 */
export async function fetchWithSchema<T>(
  url: string,
  schema: ZodSchema<T>,
  options?: RequestInit
): Promise<T> {
  const response = await fetch(url, options);
  
  if (!response.ok) {
    throw new Error(`Failed to fetch: ${response.statusText}`);
  }
  
  const data: unknown = await response.json(); // âœ… unknownã§å–å¾—
  
  // Zodã§å‹ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ‘ãƒ¼ã‚¹å¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼ã‚’æŠ•ã’ã‚‹ï¼‰
  const validatedData = schema.parse(data);
  
  return validatedData; // å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™
}

/**
 * å®‰å…¨ãªãƒ‘ãƒ¼ã‚¹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ãï¼‰
 * @param data - ãƒ‘ãƒ¼ã‚¹å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆunknownå‹ï¼‰
 * @param schema - Zodã‚¹ã‚­ãƒ¼ãƒ
 * @returns ãƒ‘ãƒ¼ã‚¹çµæœï¼ˆæˆåŠŸæ™‚ã¯dataã€å¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼æƒ…å ±ï¼‰
 */
export function safeParseWithSchema<T>(
  data: unknown,
  schema: ZodSchema<T>
): { success: true; data: T } | { success: false; error: z.ZodError } {
  const result = schema.safeParse(data);
  
  if (!result.success) {
    // ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ãƒ­ã‚°ã«å‡ºåŠ›
    console.error('Schema validation error:', {
      functionName: 'safeParseWithSchema',
      error: result.error,
      data: data,
    });
  }
  
  return result;
}
```

### å®Ÿè£…ä¾‹ï¼ˆUserå‹ã‚’ä½¿ç”¨ã—ãŸå…·ä½“ä¾‹ï¼‰

```typescript
// src/api/schema/userSchema.ts
import { z } from 'zod';
import { fetchWithSchema } from '@/api/utils/schemaUtils';

// APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ï¼ˆAPIã®å®Ÿéš›ã®æ§‹é€ ï¼‰
export const userApiSchema = z.object({
  id: z.number(),
  first_name: z.string(), // APIã¯snake_case
  last_name: z.string(),
  email: z.string().email(),
  created_at: z.string(), // APIã¯ISOæ–‡å­—åˆ—
  updated_at: z.string(),
});

// TypeScriptå‹ã‚’æ¨è«–
export type UserApiResponse = z.infer<typeof userApiSchema>;

// APIå‘¼ã³å‡ºã—é–¢æ•°ï¼ˆæ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ï¼‰
export async function fetchUser(id: number): Promise<UserApiResponse> {
  return fetchWithSchema(
    `https://api.example.com/users/${id}`,
    userApiSchema
  );
}

// è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—
export const usersApiSchema = z.array(userApiSchema);
export type UsersApiResponse = z.infer<typeof usersApiSchema>;

export async function fetchUsers(): Promise<UsersApiResponse> {
  return fetchWithSchema(
    'https://api.example.com/users',
    usersApiSchema
  );
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹

```typescript
// src/api/schema/productSchema.ts
import { z } from 'zod';
import { fetchWithSchema } from '@/api/utils/schemaUtils';

// å•†å“ã®APIã‚¹ã‚­ãƒ¼ãƒ
export const productApiSchema = z.object({
  id: z.number(),
  name: z.string(),
  price: z.number(),
  category_id: z.number(),
  created_at: z.string(),
});

export type ProductApiResponse = z.infer<typeof productApiSchema>;

// æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦å•†å“ã‚’å–å¾—
export async function fetchProduct(id: number): Promise<ProductApiResponse> {
  return fetchWithSchema(
    `https://api.example.com/products/${id}`,
    productApiSchema
  );
}

// è¤‡æ•°å•†å“å–å¾—
export const productsApiSchema = z.array(productApiSchema);
export type ProductsApiResponse = z.infer<typeof productsApiSchema>;

export async function fetchProducts(): Promise<ProductsApiResponse> {
  return fetchWithSchema(
    'https://api.example.com/products',
    productsApiSchema
  );
}
```

**ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:**

1. **`unknown`ã§å—ã‘å–ã‚‹**: `any`å‹ã¯ä½¿ã‚ãšã€å¿…ãš`unknown`ã§å–å¾—
2. **Zodã§ãƒ‘ãƒ¼ã‚¹**: `.parse()`ã§å‹ãƒã‚§ãƒƒã‚¯ï¼ˆå¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼ã‚’æŠ•ã’ã‚‹ï¼‰
3. **å®‰å…¨ãªãƒ‘ãƒ¼ã‚¹**: ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¿…è¦ãªå ´åˆã¯`.safeParse()`ã‚’ä½¿ç”¨
4. **ã‚¹ã‚­ãƒ¼ãƒã®å…±æœ‰**: APIã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã‚’ä¸€ç®‡æ‰€ã«ã¾ã¨ã‚ã‚‹
5. **æ±ç”¨é–¢æ•°ã®æ´»ç”¨**: åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™å ´åˆã¯ã€ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹é–¢æ•°ã‚’ä½œæˆã—ã¦å†åˆ©ç”¨ã™ã‚‹

### å®‰å…¨ãªãƒ‘ãƒ¼ã‚¹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼‰

```typescript
// src/api/schema/userSchema.ts
import { safeParseWithSchema } from '@/api/utils/schemaUtils';

// ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¿…è¦ãªå ´åˆ
export async function fetchUserSafely(id: number) {
  const response = await fetch(`https://api.example.com/users/${id}`);
  
  if (!response.ok) {
    throw new Error('Failed to fetch user');
  }
  
  const data: unknown = await response.json();
  
  // æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦å®‰å…¨ã«ãƒ‘ãƒ¼ã‚¹
  const result = safeParseWithSchema(data, userApiSchema);
  
  if (!result.success) {
    throw new Error('Invalid API response format');
  }
  
  return result.data; // å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿
}
```

---

## 2. DTOå±¤: UIã§ä½¿ã„ã‚„ã™ã„å½¢ã«å¤‰æ›

**å½¹å‰²**: APIã®å‹ï¼ˆsnake_caseãªã©ï¼‰ã‚’ã€UIã§ä½¿ã„ã‚„ã™ã„å½¢ï¼ˆcamelCaseã€è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã©ï¼‰ã«å¤‰æ›ã™ã‚‹ã€‚

### æ±ç”¨çš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰

```typescript
// src/utils/dtoUtils.ts

/**
 * æ±ç”¨çš„ãªé…åˆ—å¤‰æ›é–¢æ•°ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰
 * @param apiItems - APIå‹ã®é…åˆ—
 * @param converter - å˜ä¸€ã‚¢ã‚¤ãƒ†ãƒ ã®å¤‰æ›é–¢æ•°
 * @returns DTOå‹ã®é…åˆ—
 */
export function convertArray<TApi, TDto>(
  apiItems: TApi[],
  converter: (apiItem: TApi) => TDto
): TDto[] {
  return apiItems.map(converter);
}
```

### å®Ÿè£…ä¾‹ï¼ˆUserå‹ã‚’ä½¿ç”¨ã—ãŸå…·ä½“ä¾‹ï¼‰

```typescript
// src/types/user.ts
import { UserApiResponse } from '@/api/schema/userSchema';
import { convertArray } from '@/utils/dtoUtils';

// DTOå‹å®šç¾©ï¼ˆUIã§ä½¿ã„ã‚„ã™ã„å½¢ï¼‰
export type User = {
  id: number;
  firstName: string; // snake_case -> camelCase
  lastName: string;
  fullName: string; // è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆfirst + lastï¼‰
  email: string;
  createdAt: Date; // æ–‡å­—åˆ— -> Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  updatedAt: Date;
};

// APIå‹ã‹ã‚‰DTOå‹ã¸ã®å¤‰æ›é–¢æ•°
export function userApiToDto(apiUser: UserApiResponse): User {
  return {
    id: apiUser.id,
    firstName: apiUser.first_name, // snake_case -> camelCase
    lastName: apiUser.last_name,
    fullName: `${apiUser.first_name} ${apiUser.last_name}`, // è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    email: apiUser.email,
    createdAt: new Date(apiUser.created_at), // æ–‡å­—åˆ— -> Date
    updatedAt: new Date(apiUser.updated_at),
  };
}

// è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¤‰æ›ï¼ˆæ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ï¼‰
export function usersApiToDto(apiUsers: UserApiResponse[]): User[] {
  return convertArray(apiUsers, userApiToDto);
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹

```typescript
// src/types/product.ts
import { ProductApiResponse } from '@/api/schema/productSchema';
import { convertArray } from '@/utils/dtoUtils';

// å•†å“ã®DTOå‹å®šç¾©
export type Product = {
  id: number;
  name: string;
  price: number;
  formattedPrice: string; // è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆä¾¡æ ¼ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
  categoryId: number;
  createdAt: Date;
};

// APIå‹ã‹ã‚‰DTOå‹ã¸ã®å¤‰æ›é–¢æ•°
export function productApiToDto(apiProduct: ProductApiResponse): Product {
  return {
    id: apiProduct.id,
    name: apiProduct.name,
    price: apiProduct.price,
    formattedPrice: `Â¥${apiProduct.price.toLocaleString()}`, // è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    categoryId: apiProduct.category_id, // snake_case -> camelCase
    createdAt: new Date(apiProduct.created_at), // æ–‡å­—åˆ— -> Date
  };
}

// è¤‡æ•°å•†å“ã®å¤‰æ›ï¼ˆæ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ï¼‰
export function productsApiToDto(apiProducts: ProductApiResponse[]): Product[] {
  return convertArray(apiProducts, productApiToDto);
}
```

**ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:**

1. **æ˜ç¢ºãªå¤‰æ›**: APIå‹ã¨DTOå‹ã®å¤‰æ›ã‚’æ˜ç¤ºçš„ã«è¡Œã†
2. **è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**: UIã§ã‚ˆãä½¿ã†å€¤ï¼ˆ`fullName`ã€`formattedPrice`ãªã©ï¼‰ã‚’DTOå±¤ã§è¨ˆç®—
3. **å‹å¤‰æ›**: æ–‡å­—åˆ—ã®æ—¥ä»˜ã‚’`Date`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹ãªã©ã€å‹å¤‰æ›ã‚‚è¡Œã†
4. **ä¸€æ–¹å‘å¤‰æ›**: API â†’ DTOã®å¤‰æ›ã®ã¿ã‚’å®šç¾©ï¼ˆé€†å¤‰æ›ã¯åˆ¥é€”å®šç¾©ï¼‰
5. **æ±ç”¨é–¢æ•°ã®æ´»ç”¨**: é…åˆ—å¤‰æ›ãªã©ã€åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™å ´åˆã¯ã€ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹é–¢æ•°ã‚’ä½œæˆã—ã¦å†åˆ©ç”¨ã™ã‚‹

---

## 3. Formå±¤: RHFç”¨ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©

**å½¹å‰²**: React Hook Formï¼ˆRHFï¼‰ã§ä½¿ç”¨ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒ ã®å‹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹ã€‚

### æ±ç”¨çš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰

```typescript
// src/utils/formUtils.ts
import { z } from 'zod';
import { ZodSchema } from 'zod';

/**
 * ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã—ã€Zodã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
 * @param formData - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
 * @param converter - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param schema - APIãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @returns ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
 */
export function validateFormToApiRequest<TForm, TApiRequest>(
  formData: TForm,
  converter: (formData: TForm) => unknown,
  schema: ZodSchema<TApiRequest>
): TApiRequest {
  const apiRequest = converter(formData);
  return schema.parse(apiRequest);
}

/**
 * å®‰å…¨ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ãï¼‰
 * @param formData - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
 * @param converter - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param schema - APIãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @returns ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœ
 */
export function safeValidateFormToApiRequest<TForm, TApiRequest>(
  formData: TForm,
  converter: (formData: TForm) => unknown,
  schema: ZodSchema<TApiRequest>
): { success: true; data: TApiRequest } | { success: false; error: z.ZodError } {
  const apiRequest = converter(formData);
  return schema.safeParse(apiRequest);
}
```

### å®Ÿè£…ä¾‹ï¼ˆUserå‹ã‚’ä½¿ç”¨ã—ãŸå…·ä½“ä¾‹ï¼‰

```typescript
// src/components/UserForm/schema.ts
import { z } from 'zod';
import { zodResolver } from '@hookform/resolvers/zod';
import { User } from '@/types/user';
import { validateFormToApiRequest } from '@/utils/formUtils';

// ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ç”¨ã®ã‚¹ã‚­ãƒ¼ãƒï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ï¼‰
export const userFormSchema = z.object({
  firstName: z.string().min(1, 'åå‰ã¯å¿…é ˆã§ã™').max(50, 'åå‰ã¯50æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
  lastName: z.string().min(1, 'å§“ã¯å¿…é ˆã§ã™').max(50, 'å§“ã¯50æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
  email: z.string().email('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
});

// TypeScriptå‹ã‚’æ¨è«–
export type UserFormInput = z.infer<typeof userFormSchema>;

// åˆæœŸå€¤ï¼ˆdefaultValuesç”¨ï¼‰
export const defaultUserFormValues: UserFormInput = {
  firstName: '',
  lastName: '',
  email: '',
};

// DTOã‹ã‚‰ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸå€¤ã¸ã®å¤‰æ›
export function userDtoToFormInput(user: User): UserFormInput {
  return {
    firstName: user.firstName,
    lastName: user.lastName,
    email: user.email,
  };
}

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ç”¨ã®ã‚¹ã‚­ãƒ¼ãƒï¼ˆAPIã«é€ã‚‹å½¢ã«å¤‰æ›ï¼‰
export const createUserApiSchema = z.object({
  first_name: z.string(),
  last_name: z.string(),
  email: z.string().email(),
});

export type CreateUserApiRequest = z.infer<typeof createUserApiSchema>;

// ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã‹ã‚‰APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã¸ã®å¤‰æ›
export function userFormInputToApiRequest(
  formInput: UserFormInput
): CreateUserApiRequest {
  return {
    first_name: formInput.firstName, // camelCase -> snake_case
    last_name: formInput.lastName,
    email: formInput.email,
  };
}

// æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ãŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãå¤‰æ›
export function validateUserFormInput(
  formInput: UserFormInput
): CreateUserApiRequest {
  return validateFormToApiRequest(
    formInput,
    userFormInputToApiRequest,
    createUserApiSchema
  );
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹

```typescript
// src/components/ProductForm/schema.ts
import { z } from 'zod';
import { Product } from '@/types/product';
import { validateFormToApiRequest } from '@/utils/formUtils';

// å•†å“ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¹ã‚­ãƒ¼ãƒ
export const productFormSchema = z.object({
  name: z.string().min(1, 'å•†å“åã¯å¿…é ˆã§ã™').max(100, 'å•†å“åã¯100æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
  price: z.number().min(0, 'ä¾¡æ ¼ã¯0ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„'),
  categoryId: z.number().min(1, 'ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„'),
});

export type ProductFormInput = z.infer<typeof productFormSchema>;

// DTOã‹ã‚‰ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸå€¤ã¸ã®å¤‰æ›
export function productDtoToFormInput(product: Product): ProductFormInput {
  return {
    name: product.name,
    price: product.price,
    categoryId: product.categoryId,
  };
}

// APIãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®ã‚¹ã‚­ãƒ¼ãƒ
export const createProductApiSchema = z.object({
  name: z.string(),
  price: z.number(),
  category_id: z.number(),
});

export type CreateProductApiRequest = z.infer<typeof createProductApiSchema>;

// ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã‹ã‚‰APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã¸ã®å¤‰æ›
export function productFormInputToApiRequest(
  formInput: ProductFormInput
): CreateProductApiRequest {
  return {
    name: formInput.name,
    price: formInput.price,
    category_id: formInput.categoryId, // camelCase -> snake_case
  };
}

// æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ãŸãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãå¤‰æ›
export function validateProductFormInput(
  formInput: ProductFormInput
): CreateProductApiRequest {
  return validateFormToApiRequest(
    formInput,
    productFormInputToApiRequest,
    createProductApiSchema
  );
}
```

---

## 4. Pageå±¤: å¸ä»¤å¡”ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€Formã¸é…åˆ†

**å½¹å‰²**: ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€é©åˆ‡ãªå±¤ã‚’çµŒç”±ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã«æ¸¡ã™ã€‚

### å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

Pageå±¤ã§ã¯ã€ä»¥ä¸‹ã®æµã‚Œã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã™ï¼š

1. **APIå±¤**: `unknown` â†’ Strict Schema (Zodã§æ´—æµ„)
2. **DTOå±¤**: APIå‹ â†’ UIå‹ (snake_case â†’ camelCase, è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ )
3. **Formå±¤**: DTOå‹ â†’ Formå‹ (ãƒ•ã‚©ãƒ¼ãƒ ç”¨ã®å‹ã«å¤‰æ›)

> **æ³¨æ„**: ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ç‰¹æœ‰ã®å®Ÿè£…ä¾‹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
> - [Next.jsã§ã®å®Ÿè£…ä¾‹](../../nextjsã‚¬ã‚¤ãƒ‰/02_APIé–‹ç™º/02_ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°/02_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ.mdx)
> - [Reactã§ã®å®Ÿè£…ä¾‹](../../Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/02_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ.mdx)

### Actionå±¤: ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤‰æ›

**å½¹å‰²**: ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã—ã€APIã‚’å‘¼ã³å‡ºã™ã€‚

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ: ã€Œé€†æ–¹å‘ã€ã®æ´—æµ„**

- **APIã‹ã‚‰å—ã‘å–ã‚‹æ™‚**: `unknown` â†’ `zod.parse()` â†’ å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿
- **APIã«é€ã‚‹æ™‚**: ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ â†’ `zod.parse()` â†’ æ´—æµ„æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ â†’ APIé€ä¿¡

ä¸¡æ–¹å‘ã§Zodã«ã‚ˆã‚‹æ´—æµ„ã‚’è¡Œã†ã“ã¨ã§ã€å‹å®‰å…¨æ€§ã¨ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’ä¿è¨¼ã—ã¾ã™ã€‚

### æ±ç”¨çš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰

```typescript
// src/utils/actionUtils.ts
import { z } from 'zod';
import { ZodSchema } from 'zod';
import { fetchWithSchema } from '@/api/utils/schemaUtils';

/**
 * æ±ç”¨çš„ãªæ›´æ–°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰
 * @param url - APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL
 * @param formData - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
 * @param converter - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param requestSchema - APIãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @param responseSchema - APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @param method - HTTPãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 'PUT'ï¼‰
 * @returns ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿ã®APIãƒ¬ã‚¹ãƒãƒ³ã‚¹
 */
export async function updateAction<TForm, TApiRequest, TApiResponse>(
  url: string,
  formData: TForm,
  converter: (formData: TForm) => unknown,
  requestSchema: ZodSchema<TApiRequest>,
  responseSchema: ZodSchema<TApiResponse>,
  method: string = 'PUT'
): Promise<TApiResponse> {
  // 1. ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›
  const apiRequest = converter(formData);

  // 2. âœ… é‡è¦: APIã«é€ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚‚Zodã§ãƒ‘ãƒ¼ã‚¹ï¼ˆæ´—æµ„ï¼‰ã—ã¦ã‹ã‚‰é€ä¿¡
  // ã“ã‚Œã«ã‚ˆã‚Šã€DTOã‹ã‚‰ãƒ•ã‚©ãƒ¼ãƒ ã«å¤‰æ›ã—ãŸéš›ã®ã‚´ãƒŸãƒ‡ãƒ¼ã‚¿ãŒAPIã«é£›ã¶ã®ã‚’é˜²ã
  const validatedRequest = requestSchema.parse(apiRequest);

  // 3. APIã‚’å‘¼ã³å‡ºã™ï¼ˆæ´—æµ„æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ï¼‰
  const validatedResponse = await fetchWithSchema(
    url,
    responseSchema,
    {
      method,
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(validatedRequest), // âœ… æ´—æµ„æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
    }
  );

  return validatedResponse;
}

/**
 * æ±ç”¨çš„ãªä½œæˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰
 * @param url - APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURL
 * @param formData - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿
 * @param converter - ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param requestSchema - APIãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @param responseSchema - APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ã®Zodã‚¹ã‚­ãƒ¼ãƒ
 * @returns ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿ã®APIãƒ¬ã‚¹ãƒãƒ³ã‚¹
 */
export async function createAction<TForm, TApiRequest, TApiResponse>(
  url: string,
  formData: TForm,
  converter: (formData: TForm) => unknown,
  requestSchema: ZodSchema<TApiRequest>,
  responseSchema: ZodSchema<TApiResponse>
): Promise<TApiResponse> {
  return updateAction(
    url,
    formData,
    converter,
    requestSchema,
    responseSchema,
    'POST'
  );
}
```

### å®Ÿè£…ä¾‹ï¼ˆUserå‹ã‚’ä½¿ç”¨ã—ãŸå…·ä½“ä¾‹ï¼‰

```typescript
// src/actions/userActions.ts
import { updateAction } from '@/utils/actionUtils';
import { userFormInputToApiRequest } from '@/components/UserForm/schema';
import { createUserApiSchema } from '@/components/UserForm/schema';
import { userApiSchema } from '@/api/schema/userSchema';
import type { UserFormInput } from '@/components/UserForm/schema';
import type { UserApiResponse } from '@/api/schema/userSchema';

// æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ãŸæ›´æ–°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
export async function updateUserAction(
  id: number,
  formData: UserFormInput
): Promise<UserApiResponse> {
  return updateAction(
    `https://api.example.com/users/${id}`,
    formData,
    userFormInputToApiRequest,
    createUserApiSchema,
    userApiSchema,
    'PUT'
  );
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹

```typescript
// src/actions/productActions.ts
import { createAction, updateAction } from '@/utils/actionUtils';
import { productFormInputToApiRequest } from '@/components/ProductForm/schema';
import { createProductApiSchema } from '@/components/ProductForm/schema';
import { productApiSchema } from '@/api/schema/productSchema';
import type { ProductFormInput } from '@/components/ProductForm/schema';
import type { ProductApiResponse } from '@/api/schema/productSchema';

// å•†å“ä½œæˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³
export async function createProductAction(
  formData: ProductFormInput
): Promise<ProductApiResponse> {
  return createAction(
    'https://api.example.com/products',
    formData,
    productFormInputToApiRequest,
    createProductApiSchema,
    productApiSchema
  );
}

// å•†å“æ›´æ–°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
export async function updateProductAction(
  id: number,
  formData: ProductFormInput
): Promise<ProductApiResponse> {
  return updateAction(
    `https://api.example.com/products/${id}`,
    formData,
    productFormInputToApiRequest,
    createProductApiSchema,
    productApiSchema,
    'PUT'
  );
}
```

---

## ğŸ ã¾ã¨ã‚ï¼šãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®æ­£è§£

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®å…¨ä½“åƒ

```
MSWå±¤: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§APIã‚’ãƒ¢ãƒƒã‚¯ï¼ˆå®Ÿéš›ã®APIã‚µãƒ¼ãƒãƒ¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ï¼‰
  â†“
APIå±¤: unknown -> Strict Schema (Zodã§æ´—æµ„)
  â†“
DTOå±¤: APIå‹ -> UIå‹ (snake_case -> camelCase, è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ )
  â†“
Pageå±¤: å¸ä»¤å¡”ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€Formã¸é…åˆ†
  â†“
Formå±¤: RHFã¨Zodã§ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã€ã‚’ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã—ã€Actionã‚’å©ã
  â†“
Actionå±¤: Formå‹ -> APIå‹ (camelCase -> snake_case) -> APIå‘¼ã³å‡ºã—
  â†“
MSWå±¤: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™
```

### å„å±¤ã®è²¬å‹™

| å±¤ | å…¥åŠ› | å‡ºåŠ› | è²¬å‹™ | æ±ç”¨é–¢æ•°ã®ä¾‹ |
|---|------|------|------|------------|
| **MSWå±¤** | HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ | ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ | é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§APIã‚’ãƒ¢ãƒƒã‚¯ | - |
| **APIå±¤** | `unknown` | `TApiResponse` (snake_case) | APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹ãƒã‚§ãƒƒã‚¯ | `fetchWithSchema<T>()` |
| **DTOå±¤** | `TApiResponse` | `TDto` (camelCase, Date, è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£) | UIã§ä½¿ã„ã‚„ã™ã„å½¢ã«å¤‰æ› | `convertArray<TApi, TDto>()` |
| **Formå±¤** | `TDto` | `TFormInput` | ãƒ•ã‚©ãƒ¼ãƒ ç”¨ã®å‹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | `validateFormToApiRequest<TForm, TApiRequest>()` |
| **Pageå±¤** | APIå±¤ â†’ DTOå±¤ â†’ Formå±¤ | - | ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®çµ±æ‹¬ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä¾å­˜ï¼‰ | `getFormInitialValues<TApi, TDto, TForm>()` (Next.js), `useFormData<TApi, TDto, TForm>()` (React) |
| **Actionå±¤** | `TFormInput` | `TApiResponse` | ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤‰æ›ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä¾å­˜ï¼‰ | `updateAction<TForm, TApiRequest, TApiResponse>()`, `createAction<TForm, TApiRequest, TApiResponse>()` |

> **æ³¨æ„**: è¡¨å†…ã®`T`ã¯å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã®ä½¿ç”¨æ™‚ã¯ã€`User`ã€`Product`ãªã©ã®å…·ä½“çš„ãªå‹ã«ç½®ãæ›ãˆã¾ã™ã€‚

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **MSWã§ã®ãƒ¢ãƒƒã‚¯**: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§APIã‚’ãƒ¢ãƒƒã‚¯ã—ã€å®Ÿéš›ã®APIã‚µãƒ¼ãƒãƒ¼ã«ä¾å­˜ã—ãªã„ï¼ˆè©³ç´°ã¯[MSWï¼ˆãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰](./05_MSW_ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼.mdx)ã‚’å‚ç…§ï¼‰
2. **å‹å®‰å…¨æ€§ã®ç¢ºä¿**: `unknown`ã§å—ã‘å–ã‚Šã€Zodã§å‹ãƒã‚§ãƒƒã‚¯
3. **ã€Œé€†æ–¹å‘ã€ã®æ´—æµ„**: APIã‹ã‚‰å—ã‘å–ã‚‹æ™‚ã ã‘ã§ãªãã€**APIã«é€ã‚‹æ™‚ã‚‚Zodã§ãƒ‘ãƒ¼ã‚¹ï¼ˆæ´—æµ„ï¼‰**ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€DTOã‹ã‚‰ãƒ•ã‚©ãƒ¼ãƒ ã«å¤‰æ›ã—ãŸéš›ã®ã‚´ãƒŸãƒ‡ãƒ¼ã‚¿ãŒAPIã«é£›ã¶ã®ã‚’é˜²ã
4. **è²¬å‹™ã®åˆ†é›¢**: å„å±¤ã®è²¬å‹™ã‚’æ˜ç¢ºã«åˆ†ã‘ã‚‹
5. **ä¸€æ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**: MSW â†’ API â†’ DTO â†’ Formã®æµã‚Œã‚’ç¶­æŒ
6. **å¤‰æ›é–¢æ•°ã®æ˜ç¤ºåŒ–**: å‹å¤‰æ›ã‚’æ˜ç¤ºçš„ãªé–¢æ•°ã§è¡Œã†
7. **ã‚¹ã‚­ãƒ¼ãƒã®å…±æœ‰**: Zodã‚¹ã‚­ãƒ¼ãƒã‚’å…±æœ‰ã—ã¦ã€å‹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸€å…ƒç®¡ç†ï¼ˆMSWå±¤ã§ã‚‚ä½¿ç”¨ï¼‰
8. **ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®æ´»ç”¨**: åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™å ´åˆã¯ã€ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹é–¢æ•°ï¼ˆ`fetchWithSchema`ã€`convertArray`ã€`validateFormToApiRequest`ã€`updateAction`ãªã©ï¼‰ã‚’ä½œæˆã—ã¦å†åˆ©ç”¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’æ¸›ã‚‰ã—ã€ä¿å®ˆæ€§ã‚’å‘ä¸Šã•ã›ã‚‹

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

1. **APIå‹ã‚’ãã®ã¾ã¾UIã§ä½¿ç”¨**: snake_caseãŒUIã«ç›´æ¥å‡ºã¦ãã‚‹
2. **`any`å‹ã®ä½¿ç”¨**: å‹å®‰å…¨æ€§ãŒå¤±ã‚ã‚Œã‚‹
3. **å‹ãƒã‚§ãƒƒã‚¯ãªã—ã®APIå‘¼ã³å‡ºã—**: å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§
4. **UIéƒ½åˆã§APIã‚’å¤‰æ›´**: APIã¨UIãŒå¯†çµåˆã«ãªã‚‹
5. **å¤‰æ›å±¤ã®çœç•¥**: å‹å¤‰æ›ã‚’æ€ ã‚Šã€å‹ä¸æ•´åˆãŒç™ºç”Ÿã™ã‚‹

ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã‚’å®ˆã‚‹ã“ã¨ã§ã€APIã¨UIã®è²¬å‹™ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã€ä¿å®ˆæ€§ã®é«˜ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

---

## ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯åˆ¥ã®å®Ÿè£…ä¾‹

ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã®æ¦‚å¿µã¯å…±é€šã§ã™ãŒã€å®Ÿè£…ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚å„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã®å®Ÿè£…ä¾‹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- **[Next.jsã§ã®å®Ÿè£…ä¾‹](../../nextjsã‚¬ã‚¤ãƒ‰/02_APIé–‹ç™º/02_ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°/02_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ.mdx)**: Server Componentsã€Server Actionsã‚’ä½¿ç”¨ã—ãŸå®Ÿè£…
- **[Reactã§ã®å®Ÿè£…ä¾‹](../../Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/02_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ.mdx)**: useEffectã€useStateã€React Hook Formã‚’ä½¿ç”¨ã—ãŸå®Ÿè£…
