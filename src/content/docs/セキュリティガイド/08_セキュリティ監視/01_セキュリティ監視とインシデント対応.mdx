---
title: "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ"
label: "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ"
---

## ğŸ“Š ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

`ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–`ã¨`ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ`ã¯ã€`ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ`ã‚’æ—©æœŸã«ç™ºè¦‹ã—ã€è¿…é€Ÿã«å¯¾å¿œã™ã‚‹ãŸã‚ã®é‡è¦ãªãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚

### ğŸ¯ ãªãœã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãŒé‡è¦ãªã®ã‹

#### âš ï¸ ç›£è¦–ã®ä¸å‚™ã«ã‚ˆã‚‹å•é¡Œ

**ğŸ’¡ å®Ÿéš›ã®äº‹ä¾‹:**

2021å¹´ã€ã‚ã‚‹ä¼æ¥­ã§`ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–`ãŒä¸ååˆ†ã§ã—ãŸï¼š

- ğŸ”¥ **å•é¡Œ**: ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ãŒ3ãƒ¶æœˆé–“ç™ºè¦‹ã•ã‚Œãªã‹ã£ãŸ
- ğŸ”¥ **çµæœ**: ç´„100ä¸‡äººã®`å€‹äººæƒ…å ±`ãŒæ¼æ´©
- ğŸ’¸ **å½±éŸ¿**: 
  - ç´„30å„„å††ã®æå®³è³ å„Ÿ
  - ã‚µãƒ¼ãƒ“ã‚¹ã®ä¿¡é ¼å¤±å¢œ
  - æ³•çš„è²¬ä»»ãŒå•ã‚ã‚ŒãŸ

**æ•™è¨“:**
- âœ… `ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–`ã¯å¿…é ˆ
- âœ… `ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ`ã®æº–å‚™ãŒé‡è¦

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–

#### 1. ãƒ­ã‚°ç›£è¦–

**ãƒ­ã‚°ã®åé›†ã¨åˆ†æ:**

```javascript
// ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°ã®åé›†
class SecurityLogging {
  async logSecurityEvent(event) {
    // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ­ã‚°ã«è¨˜éŒ²
    const logEntry = {
      timestamp: new Date().toISOString(),
      eventType: event.type,
      severity: event.severity,
      userId: event.userId,
      ipAddress: event.ipAddress,
      userAgent: event.userAgent,
      details: event.details,
    };
    
    // ãƒ­ã‚°ã‚’ä¿å­˜
    await db.securityLogs.create(logEntry);
    
    // ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã«é€ä¿¡ï¼ˆELK Stackã€Splunkãªã©ï¼‰
    await this.sendToLogService(logEntry);
    
    // é‡å¤§ãªã‚¤ãƒ™ãƒ³ãƒˆã®å ´åˆã¯ã‚¢ãƒ©ãƒ¼ãƒˆ
    if (event.severity === 'critical' || event.severity === 'high') {
      await this.sendAlert(logEntry);
    }
  }
  
  async detectAnomalies() {
    // ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
    const recentLogs = await db.securityLogs.find({
      timestamp: { $gte: new Date(Date.now() - 60 * 60 * 1000) },  // éå»1æ™‚é–“
    });
    
    // ç•°å¸¸ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã‚’æ¤œå‡º
    const failedLogins = recentLogs.filter(
      log => log.eventType === 'login_failed'
    );
    
    if (failedLogins.length > 10) {
      // ç•°å¸¸ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã‚’ã‚¢ãƒ©ãƒ¼ãƒˆ
      await this.sendAlert({
        type: 'anomaly',
        description: 'ç•°å¸¸ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ',
        count: failedLogins.length,
        logs: failedLogins,
      });
    }
    
    // ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
    const accessPatterns = this.analyzeAccessPatterns(recentLogs);
    const anomalies = this.detectPatternAnomalies(accessPatterns);
    
    if (anomalies.length > 0) {
      await this.sendAlert({
        type: 'anomaly',
        description: 'ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ',
        anomalies,
      });
    }
  }
}
```

#### 2. ä¾µå…¥æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆIDSï¼‰

**IDSã®å®Ÿè£…:**

```javascript
// ä¾µå…¥æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆIDSï¼‰ã®å®Ÿè£…
class IntrusionDetectionSystem {
  async detectIntrusion(request) {
    // 1. ã‚·ã‚°ãƒãƒãƒ£ãƒ™ãƒ¼ã‚¹ã®æ¤œçŸ¥
    const signatureMatch = await this.checkSignatures(request);
    if (signatureMatch) {
      await this.logIntrusion({
        type: 'signature',
        request,
        signature: signatureMatch,
      });
      return true;
    }
    
    // 2. ç•°å¸¸æ¤œçŸ¥ãƒ™ãƒ¼ã‚¹ã®æ¤œçŸ¥
    const anomaly = await this.detectAnomaly(request);
    if (anomaly) {
      await this.logIntrusion({
        type: 'anomaly',
        request,
        anomaly,
      });
      return true;
    }
    
    return false;
  }
  
  async checkSignatures(request) {
    // æ—¢çŸ¥ã®æ”»æ’ƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
    const signatures = [
      { pattern: /union.*select/i, type: 'sql_injection' },
      { pattern: /<script.*>/i, type: 'xss' },
      { pattern: /\.\.\//, type: 'path_traversal' },
      { pattern: /eval\(/i, type: 'code_injection' },
    ];
    
    for (const signature of signatures) {
      if (signature.pattern.test(request.url) || 
          signature.pattern.test(request.body)) {
        return signature;
      }
    }
    
    return null;
  }
  
  async detectAnomaly(request) {
    // ç•°å¸¸ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
    const userHistory = await this.getUserHistory(request.userId);
    
    // ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹æ™‚é–“
    const hour = new Date().getHours();
    if (hour < 6 || hour > 22) {
      if (!userHistory.nightAccess) {
        return { type: 'unusual_time', hour };
      }
    }
    
    // ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹å ´æ‰€
    const location = await this.getLocation(request.ipAddress);
    if (location.country !== userHistory.commonCountry) {
      return { type: 'unusual_location', location };
    }
    
    // ç•°å¸¸ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦
    const requestCount = await this.getRequestCount(
      request.userId,
      Date.now() - 60 * 1000  // éå»1åˆ†
    );
    if (requestCount > 100) {
      return { type: 'unusual_frequency', count: requestCount };
    }
    
    return null;
  }
}
```

#### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æƒ…å ±ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ï¼ˆSIEMï¼‰

**SIEMã®å®Ÿè£…:**

```javascript
// SIEMã®å®Ÿè£…
class SIEM {
  async collectEvents() {
    // è¤‡æ•°ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’åé›†
    const events = await Promise.all([
      this.collectApplicationLogs(),
      this.collectNetworkLogs(),
      this.collectSystemLogs(),
      this.collectSecurityLogs(),
    ]);
    
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ­£è¦åŒ–
    const normalizedEvents = events.flat().map(event => 
      this.normalizeEvent(event)
    );
    
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›¸é–¢åˆ†æ
    const correlatedEvents = await this.correlateEvents(normalizedEvents);
    
    // ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç”Ÿæˆ
    await this.generateAlerts(correlatedEvents);
    
    return correlatedEvents;
  }
  
  async correlateEvents(events) {
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›¸é–¢åˆ†æ
    const correlations = [];
    
    // åŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®è¤‡æ•°ã®å¤±æ•—ã—ãŸãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ
    const failedLoginsByIP = this.groupBy(events, 'ipAddress')
      .filter(group => 
        group.events.some(e => e.type === 'login_failed')
      );
    
    for (const group of failedLoginsByIP) {
      if (group.events.length > 5) {
        correlations.push({
          type: 'brute_force_attack',
          ipAddress: group.ipAddress,
          events: group.events,
          severity: 'high',
        });
      }
    }
    
    // ç•°å¸¸ãªãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³
    const dataAccessPatterns = this.analyzeDataAccess(events);
    const anomalies = this.detectDataAccessAnomalies(dataAccessPatterns);
    
    for (const anomaly of anomalies) {
      correlations.push({
        type: 'data_exfiltration',
        anomaly,
        severity: 'critical',
      });
    }
    
    return correlations;
  }
  
  async generateAlerts(correlations) {
    // ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç”Ÿæˆ
    for (const correlation of correlations) {
      if (correlation.severity === 'critical' || 
          correlation.severity === 'high') {
        await this.sendAlert({
          type: correlation.type,
          severity: correlation.severity,
          details: correlation,
          timestamp: new Date(),
        });
      }
    }
  }
}
```

### ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

#### 1. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»

**ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»ã®ä½œæˆ:**

```markdown
# ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»

## 1. æº–å‚™
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒãƒ¼ãƒ ã®ç·¨æˆ
- é€£çµ¡å…ˆãƒªã‚¹ãƒˆã®ä½œæˆ
- ãƒ„ãƒ¼ãƒ«ã¨ãƒªã‚½ãƒ¼ã‚¹ã®æº–å‚™

## 2. æ¤œçŸ¥
- ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹è‡ªå‹•æ¤œçŸ¥
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å ±å‘Š
- å¤–éƒ¨ã‹ã‚‰ã®é€šçŸ¥

## 3. åˆ†æ
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®ç¨®é¡ã®ç‰¹å®š
- å½±éŸ¿ç¯„å›²ã®è©•ä¾¡
- æ·±åˆ»åº¦ã®è©•ä¾¡

## 4. å°ã˜è¾¼ã‚
- å½±éŸ¿ç¯„å›²ã®é™å®š
- æ”»æ’ƒè€…ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’é®æ–­
- ã‚·ã‚¹ãƒ†ãƒ ã®éš”é›¢

## 5. æ ¹çµ¶
- è„†å¼±æ€§ã®ä¿®æ­£
- ãƒãƒ«ã‚¦ã‚§ã‚¢ã®å‰Šé™¤
- ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã®æ’é™¤

## 6. å¾©æ—§
- ã‚·ã‚¹ãƒ†ãƒ ã®å¾©æ—§
- ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒ
- ã‚µãƒ¼ãƒ“ã‚¹ã®å†é–‹

## 7. äº‹å¾Œå¯¾å¿œ
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆ
- å†ç™ºé˜²æ­¢ç­–ã®å®Ÿæ–½
- æ”¹å–„ç‚¹ã®ç‰¹å®š
```

#### 2. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®è‡ªå‹•åŒ–

**ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®è‡ªå‹•åŒ–:**

```javascript
// ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®è‡ªå‹•åŒ–
class IncidentResponse {
  async handleIncident(incident) {
    // 1. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®æ·±åˆ»åº¦ã‚’è©•ä¾¡
    const severity = await this.assessSeverity(incident);
    
    // 2. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒãƒ¼ãƒ ã«é€šçŸ¥
    await this.notifyTeam(incident, severity);
    
    // 3. è‡ªå‹•çš„ãªå°ã˜è¾¼ã‚
    if (severity === 'critical' || severity === 'high') {
      await this.automaticContainment(incident);
    }
    
    // 4. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ
    const incidentRecord = await this.createIncidentRecord(incident);
    
    // 5. ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚¿ã‚¹ã‚¯ã®ä½œæˆ
    await this.createFollowupTasks(incidentRecord);
    
    return incidentRecord;
  }
  
  async automaticContainment(incident) {
    // è‡ªå‹•çš„ãªå°ã˜è¾¼ã‚
    switch (incident.type) {
      case 'brute_force_attack':
        // IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒ–ãƒ­ãƒƒã‚¯
        await this.blockIPAddress(incident.ipAddress);
        break;
      
      case 'malware':
        // å½±éŸ¿ã‚’å—ã‘ãŸã‚·ã‚¹ãƒ†ãƒ ã‚’éš”é›¢
        await this.isolateSystem(incident.systemId);
        break;
      
      case 'data_breach':
        // å½±éŸ¿ã‚’å—ã‘ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç„¡åŠ¹åŒ–
        await this.disableAffectedAccounts(incident.affectedAccounts);
        break;
    }
  }
  
  async createIncidentRecord(incident) {
    // ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
    return await db.incidents.create({
      id: this.generateIncidentId(),
      type: incident.type,
      severity: incident.severity,
      status: 'open',
      detectedAt: new Date(),
      description: incident.description,
      affectedSystems: incident.affectedSystems,
      assignedTo: await this.assignIncident(incident),
    });
  }
}
```

### ã¾ã¨ã‚

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®ãƒã‚¤ãƒ³ãƒˆï¼š

- **ãƒ­ã‚°ç›£è¦–**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã®è¨˜éŒ²ã¨åˆ†æ
- **ä¾µå…¥æ¤œçŸ¥**: ã‚·ã‚°ãƒãƒãƒ£ãƒ™ãƒ¼ã‚¹ã¨ç•°å¸¸æ¤œçŸ¥ãƒ™ãƒ¼ã‚¹ã®æ¤œçŸ¥
- **SIEM**: è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆåé›†ã¨ç›¸é–¢åˆ†æ
- **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»**: æº–å‚™ã€æ¤œçŸ¥ã€åˆ†æã€å°ã˜è¾¼ã‚ã€æ ¹çµ¶ã€å¾©æ—§ã€äº‹å¾Œå¯¾å¿œ
- **è‡ªå‹•åŒ–**: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®è‡ªå‹•åŒ–ã€è¿…é€Ÿãªå¯¾å¿œ

é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚’æ—©æœŸã«ç™ºè¦‹ã—ã€è¿…é€Ÿã«å¯¾å¿œã§ãã¾ã™ã€‚

