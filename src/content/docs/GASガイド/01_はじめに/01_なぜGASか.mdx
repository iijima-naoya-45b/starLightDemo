---
title: "ãªãœGASã‹"
label: "ãªãœGASã‹"
---

## ğŸš€ ãªãœGoogle Apps Scriptï¼ˆGASï¼‰ã‹

Google Apps Scriptï¼ˆ`GAS`ï¼‰ã¯ã€Googleã®å„ç¨®ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€Gmailã€Driveã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãªã©ï¼‰ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å®Ÿè¡Œç’°å¢ƒã§ã™ã€‚å®Ÿå‹™ã§ã®ä½¿ã„æ–¹ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚

### ğŸ“‹ GASã¨ã¯

Google Apps Scriptã¯ã€JavaScriptãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œç’°å¢ƒã§ã€Googleã®å„ç¨®ã‚µãƒ¼ãƒ“ã‚¹ã¨çµ±åˆã—ã¦è‡ªå‹•åŒ–ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

**ğŸ“‹ ä¸»ãªç‰¹å¾´:**

- â˜ï¸ **ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**: ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†ãŒä¸è¦
- ğŸ’° **ç„¡æ–™**: å€‹äººåˆ©ç”¨ã¯ç„¡æ–™ï¼ˆåˆ¶é™ã‚ã‚Šï¼‰
- ğŸ”— **Googleã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ**: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€Gmailã€Driveãªã©ã¨ç›´æ¥é€£æº
- â° **ãƒˆãƒªã‚¬ãƒ¼å®Ÿè¡Œ**: æ™‚é–“ãƒ™ãƒ¼ã‚¹ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•å®Ÿè¡Œ
- ğŸŒ **Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: HTMLã‚µãƒ¼ãƒ“ã‚¹ã§Webã‚¢ãƒ—ãƒªã‚’ä½œæˆå¯èƒ½

### ğŸ¯ GASãŒé©ã—ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹

#### ğŸ¤– 1. Google Workspaceã®è‡ªå‹•åŒ–

```javascript
// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®è‡ªå‹•æ›´æ–°
function updateSpreadsheet() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const data = fetchDataFromAPI();
  sheet.getRange(1, 1, data.length, data[0].length).setValues(data);
}

// ãƒˆãƒªã‚¬ãƒ¼ã§æ¯æ—¥è‡ªå‹•å®Ÿè¡Œ
function createDailyTrigger() {
  ScriptApp.newTrigger('updateSpreadsheet')
    .timeBased()
    .everyDays(1)
    .atHour(9)
    .create();
}
```

#### 2. ãƒ‡ãƒ¼ã‚¿é€£æºã¨ETLå‡¦ç†

```javascript
// å¤–éƒ¨APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜
function syncDataFromAPI() {
  const response = UrlFetchApp.fetch('https://api.example.com/data');
  const data = JSON.parse(response.getContentText());
  
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Data');
  const values = data.map(item => [item.id, item.name, item.value]);
  sheet.getRange(1, 1, values.length, values[0].length).setValues(values);
}
```

#### 3. é€šçŸ¥ã¨ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•é€ä¿¡

```javascript
// æ¯æ—¥ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡
function sendDailyReport() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet();
  const data = sheet.getDataRange().getValues();
  
  const htmlBody = `
    <h2>æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</h2>
    <p>æœ¬æ—¥ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°: ${data.length - 1}ä»¶</p>
    <table>
      ${data.slice(1, 6).map(row => 
        `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`
      ).join('')}
    </table>
  `;
  
  MailApp.sendEmail({
    to: 'team@example.com',
    subject: 'æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ',
    htmlBody: htmlBody,
  });
}
```

### GASã®åˆ¶é™äº‹é …

#### å®Ÿè¡Œæ™‚é–“åˆ¶é™

- **é€šå¸¸ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: 6åˆ†
- **G Suite Business/Enterprise**: 30åˆ†ï¼ˆæœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼‰

```javascript
// âŒ æ‚ªã„ä¾‹: é•·æ™‚é–“å®Ÿè¡Œã•ã‚Œã‚‹å‡¦ç†
function processLargeData() {
  const data = fetchLargeData(); // 10åˆ†ã‹ã‹ã‚‹
  processData(data); // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼
}

// âœ… è‰¯ã„ä¾‹: ãƒãƒƒãƒå‡¦ç†ã«åˆ†å‰²
function processLargeData() {
  const batchSize = 100;
  let offset = 0;
  
  while (true) {
    const batch = fetchDataBatch(offset, batchSize);
    if (batch.length === 0) break;
    
    processBatch(batch);
    offset += batchSize;
    
    // å®Ÿè¡Œæ™‚é–“ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆ5åˆ†ã§åœæ­¢ï¼‰
    if (getElapsedTime() > 5 * 60 * 1000) {
      // æ¬¡å›å®Ÿè¡Œç”¨ã«çŠ¶æ…‹ã‚’ä¿å­˜
      PropertiesService.getScriptProperties().setProperty('offset', offset);
      break;
    }
  }
}
```

#### ã‚¯ã‚©ãƒ¼ã‚¿åˆ¶é™

- **1æ—¥ã®å®Ÿè¡Œæ™‚é–“**: 6æ™‚é–“ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **åŒæ™‚å®Ÿè¡Œæ•°**: 30ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **URLãƒ•ã‚§ãƒƒãƒ**: 20,000å›/æ—¥
- **ãƒ¡ãƒ¼ãƒ«é€ä¿¡**: 100é€š/æ—¥ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰

```javascript
// âœ… è‰¯ã„ä¾‹: ã‚¯ã‚©ãƒ¼ã‚¿ã‚’è€ƒæ…®ã—ãŸå®Ÿè£…
function sendBulkEmails(recipients) {
  const dailyLimit = 100;
  const sentToday = getSentCountToday();
  
  if (sentToday >= dailyLimit) {
    Logger.log('Daily email limit reached');
    return;
  }
  
  const remaining = dailyLimit - sentToday;
  const toSend = recipients.slice(0, remaining);
  
  toSend.forEach(recipient => {
    MailApp.sendEmail({
      to: recipient.email,
      subject: recipient.subject,
      body: recipient.body,
    });
  });
}
```

### GASã®å®Ÿè¡Œç’°å¢ƒ

#### Serverlessç’°å¢ƒ

GASã¯ã€Google Cloud Platformä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã™ã€‚

**ç‰¹å¾´:**

- **ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆ**: åˆå›å®Ÿè¡Œæ™‚ã«èµ·å‹•æ™‚é–“ãŒã‹ã‹ã‚‹ï¼ˆæ•°ç§’ï¼‰
- **è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã«å¿œã˜ã¦è‡ªå‹•çš„ã«ã‚¹ã‚±ãƒ¼ãƒ«
- **ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹**: å®Ÿè¡Œé–“ã§çŠ¶æ…‹ã‚’ä¿æŒã—ãªã„ï¼ˆPropertiesServiceã‚’ä½¿ç”¨ï¼‰

```javascript
// âœ… è‰¯ã„ä¾‹: çŠ¶æ…‹ã‚’PropertiesServiceã«ä¿å­˜
function saveState(key, value) {
  PropertiesService.getScriptProperties().setProperty(key, JSON.stringify(value));
}

function loadState(key) {
  const value = PropertiesService.getScriptProperties().getProperty(key);
  return value ? JSON.parse(value) : null;
}

// å®Ÿè¡Œé–“ã§çŠ¶æ…‹ã‚’ä¿æŒ
function processData() {
  let offset = loadState('offset') || 0;
  const batch = fetchDataBatch(offset, 100);
  processBatch(batch);
  saveState('offset', offset + batch.length);
}
```

### ã¾ã¨ã‚

GASã¯ã€Google Workspaceã®è‡ªå‹•åŒ–ã‚„ãƒ‡ãƒ¼ã‚¿é€£æºã«æœ€é©ãªã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å®Ÿè¡Œç’°å¢ƒã§ã™ã€‚

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ:**

- **å®Ÿè¡Œæ™‚é–“åˆ¶é™**: 6åˆ†ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰ã¾ãŸã¯30åˆ†ï¼ˆæœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **ã‚¯ã‚©ãƒ¼ã‚¿åˆ¶é™**: 1æ—¥ã®å®Ÿè¡Œæ™‚é–“ã€åŒæ™‚å®Ÿè¡Œæ•°ã€URLãƒ•ã‚§ãƒƒãƒå›æ•°ãªã©
- **Serverlessç’°å¢ƒ**: ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹
- **Googleã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ**: ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€Gmailã€Driveãªã©ã¨ç›´æ¥é€£æº

ã“ã‚Œã‚‰ã®ç‰¹å¾´ã‚’ç†è§£ã—ã€é©åˆ‡ã«è¨­è¨ˆã™ã‚‹ã“ã¨ã§ã€å …ç‰¢ã§åŠ¹ç‡çš„ãªGASã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

