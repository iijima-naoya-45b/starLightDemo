---
title: "é«˜åº¦ãªè¨˜è¿°æ–¹æ³•"
label: "é«˜åº¦ãªè¨˜è¿°æ–¹æ³•"
---

## ğŸš€ é«˜åº¦ãªè¨˜è¿°æ–¹æ³•

`OpenAPI`ä»•æ§˜ã®é«˜åº¦ãªè¨˜è¿°æ–¹æ³•ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚

### âœ… ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### ğŸ“‹ ã‚¹ã‚­ãƒ¼ãƒã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```yaml
components:
  schemas:
    User:
      type: object
      required:
        - id
        - name
        - email
      properties:
        id:
          type: string
          format: uuid
          pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
        name:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[a-zA-Z ]+$'
        email:
          type: string
          format: email
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        age:
          type: integer
          minimum: 0
          maximum: 150
        score:
          type: number
          minimum: 0
          maximum: 100
          multipleOf: 0.5
        tags:
          type: array
          items:
            type: string
          minItems: 1
          maxItems: 10
          uniqueItems: true
```

### ğŸ”„ ç¶™æ‰¿ã¨ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³

#### ğŸ“‹ allOfï¼ˆç¶™æ‰¿ï¼‰

```yaml
components:
  schemas:
    BaseUser:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
    
    AdminUser:
      allOf:
        - $ref: '#/components/schemas/BaseUser'
        - type: object
          properties:
            permissions:
              type: array
              items:
                type: string
    
    RegularUser:
      allOf:
        - $ref: '#/components/schemas/BaseUser'
        - type: object
          properties:
            subscription:
              type: string
```

#### âš–ï¸ oneOf/anyOfï¼ˆé¸æŠï¼‰

```yaml
components:
  schemas:
    PaymentMethod:
      oneOf:
        - $ref: '#/components/schemas/CreditCard'
        - $ref: '#/components/schemas/BankAccount'
        - $ref: '#/components/schemas/DigitalWallet'
      discriminator:
        propertyName: type
        mapping:
          credit_card: '#/components/schemas/CreditCard'
          bank_account: '#/components/schemas/BankAccount'
          digital_wallet: '#/components/schemas/DigitalWallet'
    
    CreditCard:
      type: object
      required:
        - type
        - cardNumber
      properties:
        type:
          type: string
          enum: [credit_card]
        cardNumber:
          type: string
        expiryDate:
          type: string
```

### ğŸ¨ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

#### ğŸ“‹ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å®šç¾©

```yaml
components:
  schemas:
    CustomDate:
      type: string
      format: date
      pattern: '^\d{4}-\d{2}-\d{2}$'
      example: "2024-01-01"
    
    CustomDateTime:
      type: string
      format: date-time
      pattern: '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$'
      example: "2024-01-01T00:00:00Z"
    
    PhoneNumber:
      type: string
      pattern: '^\+?[1-9]\d{1,14}$'
      example: "+81-90-1234-5678"
    
    PostalCode:
      type: string
      pattern: '^\d{3}-\d{4}$'
      example: "123-4567"
```

### âš™ï¸ æ¡ä»¶ä»˜ããƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### ğŸ“‹ æ¡ä»¶ä»˜ããƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…

```yaml
components:
  schemas:
    Order:
      type: object
      required:
        - items
        - paymentMethod
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItem'
        paymentMethod:
          $ref: '#/components/schemas/PaymentMethod'
        shippingAddress:
          $ref: '#/components/schemas/Address'
        billingAddress:
          $ref: '#/components/schemas/Address'
      # æ¡ä»¶: é…é€å…ˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€è«‹æ±‚å…ˆã‚‚å¿…é ˆ
      if:
        properties:
          shippingAddress:
            type: object
      then:
        required:
          - billingAddress
```

### ğŸ”— ãƒªãƒ³ã‚¯ã¨ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯

#### ğŸ”— ãƒªãƒ³ã‚¯ï¼ˆLinkï¼‰

```yaml
paths:
  /api/users/{userId}:
    get:
      operationId: getUser
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          links:
            updateUser:
              operationId: updateUser
              parameters:
                userId: '$response.body#/id'
            deleteUser:
              operationId: deleteUser
              parameters:
                userId: '$response.body#/id'
```

#### ğŸ“ ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆCallbackï¼‰

```yaml
paths:
  /api/webhooks:
    post:
      operationId: createWebhook
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
      callbacks:
        onEvent:
          '{$request.body#/url}':
            post:
              requestBody:
                content:
                  application/json:
                    schema:
                      $ref: '#/components/schemas/WebhookPayload'
              responses:
                '200':
                  description: Webhookå—ä¿¡æˆåŠŸ
```

### ğŸ“ å¤–éƒ¨å‚ç…§

#### ğŸ“‹ å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®å‚ç…§

```yaml
# main.yaml
openapi: 3.0.0
info:
  title: My API
  version: 1.0.0
paths:
  /api/users:
    $ref: './paths/users.yaml'
components:
  schemas:
    User:
      $ref: './schemas/User.yaml'
```

```yaml
# paths/users.yaml
get:
  summary: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—
  responses:
    '200':
      description: æˆåŠŸ
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '../schemas/User.yaml'
```

### ğŸ”§ æ‹¡å¼µï¼ˆExtensionsï¼‰

#### ğŸ“‹ ã‚«ã‚¹ã‚¿ãƒ æ‹¡å¼µ

```yaml
paths:
  /api/users:
    get:
      summary: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—
      x-codegen:
        methodName: getUsers
        returnType: User[]
      x-rate-limit:
        requests: 100
        period: 60
      x-examples:
        - name: Example 1
          value:
            users:
              - id: "1"
                name: "John Doe"
      responses:
        '200':
          description: æˆåŠŸ
          x-response-time: 100ms
```

### ğŸ¯ ã¾ã¨ã‚

é«˜åº¦ãªè¨˜è¿°æ–¹æ³•ã®ãƒã‚¤ãƒ³ãƒˆï¼š

- âœ… **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: è©³ç´°ãª`ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³`ãƒ«ãƒ¼ãƒ«
- ğŸ”„ **ç¶™æ‰¿ã¨ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³**: allOfã€oneOfã€anyOf
- ğŸ¨ **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: ç‹¬è‡ªã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®šç¾©
- âš™ï¸ **æ¡ä»¶ä»˜ããƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: æ¡ä»¶ã«å¿œã˜ãŸ`ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³`
- ğŸ”— **ãƒªãƒ³ã‚¯ã¨ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯**: é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®šç¾©
- ğŸ“ **å¤–éƒ¨å‚ç…§**: ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ã¨å†åˆ©ç”¨
- ğŸ”§ **æ‹¡å¼µ**: ã‚«ã‚¹ã‚¿ãƒ æ‹¡å¼µã®ä½¿ç”¨

é©åˆ‡ãªé«˜åº¦ãªè¨˜è¿°æ–¹æ³•ã«ã‚ˆã‚Šã€ã‚ˆã‚Šè©³ç´°ã§æŸ”è»Ÿãª`APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ`ã‚’ä½œæˆã§ãã¾ã™ã€‚

