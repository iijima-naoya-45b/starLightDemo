---
title: "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ"
label: "ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ"
---

## ğŸ”„ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆï¼šãƒ‡ãƒ¼ã‚¿ã®å‹ç®¡ç†ã¨ç”»é¢æ¥ç¶šã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[è¨­è¨ˆã‚¬ã‚¤ãƒ‰ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ](../../../../../è¨­è¨ˆã‚¬ã‚¤ãƒ‰/02_apiè¨­è¨ˆ/04_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Next.jsï¼ˆApp Routerï¼‰ç‰¹æœ‰ã®å®Ÿè£…ä¾‹ã‚’ä¸­å¿ƒã«èª¬æ˜ã—ã¾ã™ã€‚

### Next.jsã§ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã®å®Ÿè£…

Next.jsã§ã¯ã€Server Componentsã¨Server Actionsã‚’æ´»ç”¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã‚’å®Ÿè£…ã§ãã¾ã™ã€‚

---

## Next.jsã§ã®å®Ÿè£…ä¾‹

### Schemaå±¤ã€DTOå±¤ã€Formå±¤ã®å®Ÿè£…

å„å±¤ã®è©³ç´°ãªå®Ÿè£…ã«ã¤ã„ã¦ã¯ã€[è¨­è¨ˆã‚¬ã‚¤ãƒ‰ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ](../../../../../è¨­è¨ˆã‚¬ã‚¤ãƒ‰/02_apiè¨­è¨ˆ/04_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### Pageå±¤: å¸ä»¤å¡”ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€Formã¸é…åˆ†

**å½¹å‰²**: ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆPageï¼‰ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€é©åˆ‡ãªå±¤ã‚’çµŒç”±ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã«æ¸¡ã™ã€‚

### æ±ç”¨çš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼‰

```typescript
// utils/pageUtils.ts

/**
 * æ±ç”¨çš„ãªãƒšãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°ï¼ˆã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼‰
 * @param fetchFn - APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹é–¢æ•°
 * @param apiToDto - APIå‹ã‚’DTOå‹ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param dtoToForm - DTOå‹ã‚’ãƒ•ã‚©ãƒ¼ãƒ å‹ã«å¤‰æ›ã™ã‚‹é–¢æ•°
 * @param params - fetchFnã«æ¸¡ã™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
 * @returns ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸå€¤
 */
export async function getFormInitialValues<TApi, TDto, TForm, TParams>(
  fetchFn: (params: TParams) => Promise<TApi>,
  apiToDto: (api: TApi) => TDto,
  dtoToForm: (dto: TDto) => TForm,
  params: TParams
): Promise<TForm> {
  // 1. APIå±¤: unknown -> Strict Schema
  const apiData = await fetchFn(params);

  // 2. DTOå±¤: APIå‹ -> UIå‹
  const dto = apiToDto(apiData);

  // 3. Formå±¤: DTOå‹ -> Formå‹
  const formInitialValues = dtoToForm(dto);

  return formInitialValues;
}
```

### å®Ÿè£…ä¾‹ï¼ˆUserå‹ã‚’ä½¿ç”¨ã—ãŸå…·ä½“ä¾‹ï¼‰

```typescript
// app/users/[id]/edit/page.tsx
import { fetchUser } from '@/api/schema/userSchema';
import { userApiToDto } from '@/types/user';
import { userDtoToFormInput } from '@/components/UserForm/schema';
import UserForm from '@/components/UserForm/UserForm';
import { updateUserAction } from './actions';
import { getFormInitialValues } from '@/utils/pageUtils';

type EditUserPageProps = {
  params: Promise<{
    id: string;
  }>;
};

export default async function EditUserPage({ params }: EditUserPageProps) {
  // Next.js 15ä»¥é™: paramsã‚’awaitã™ã‚‹å¿…è¦ãŒã‚ã‚‹
  const { id } = await params;
  const userId = Number(id);

  // æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸå€¤ã‚’å–å¾—
  const formInitialValues = await getFormInitialValues(
    fetchUser,
    userApiToDto,
    userDtoToFormInput,
    userId
  );

  // 4. ãƒ•ã‚©ãƒ¼ãƒ ã«æ¸¡ã™
  return (
    <div>
      <h1>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†</h1>
      <UserForm
        initialValues={formInitialValues}
        userId={userId}
        onSubmit={updateUserAction}
      />
    </div>
  );
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹ï¼ˆProductå‹ï¼‰

```typescript
// app/products/[id]/edit/page.tsx
import { fetchProduct } from '@/api/schema/productSchema';
import { productApiToDto } from '@/types/product';
import { productDtoToFormInput } from '@/components/ProductForm/schema';
import ProductForm from '@/components/ProductForm/ProductForm';
import { updateProductAction } from './actions';
import { getFormInitialValues } from '@/utils/pageUtils';

type EditProductPageProps = {
  params: Promise<{
    id: string;
  }>;
};

export default async function EditProductPage({ params }: EditProductPageProps) {
  const { id } = await params;
  const productId = Number(id);

  // æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸå€¤ã‚’å–å¾—
  const formInitialValues = await getFormInitialValues(
    fetchProduct,
    productApiToDto,
    productDtoToFormInput,
    productId
  );

  return (
    <div>
      <h1>å•†å“ç·¨é›†</h1>
      <ProductForm
        initialValues={formInitialValues}
        productId={productId}
        onSubmit={updateProductAction}
      />
    </div>
  );
}
```

### Server Actionã§ã®å®Ÿè£…ï¼ˆæ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ï¼‰

```typescript
// app/users/[id]/edit/actions.ts
'use server';

import { updateAction } from '@/utils/actionUtils';
import { userFormInputToApiRequest } from '@/components/UserForm/schema';
import { createUserApiSchema } from '@/components/UserForm/schema';
import { userApiSchema } from '@/api/schema/userSchema';
import { revalidatePath } from 'next/cache';
import type { UserFormInput } from '@/components/UserForm/schema';
import type { UserApiResponse } from '@/api/schema/userSchema';

// useActionStateç”¨ã®å‹å®šç¾©
type ActionState = {
  errors?: {
    firstName?: string;
    lastName?: string;
    email?: string;
    general?: string;
  };
  success?: boolean;
};

export async function updateUserAction(
  prevState: ActionState | null,
  formData: FormData
): Promise<ActionState> {
  // 1. FormDataã‹ã‚‰å€¤ã‚’å–å¾—
  const firstName = formData.get('firstName') as string;
  const lastName = formData.get('lastName') as string;
  const email = formData.get('email') as string;
  const userId = Number(formData.get('userId'));

  // 2. ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹ç¯‰
  const formInput: UserFormInput = {
    firstName,
    lastName,
    email,
  };

  try {
    // 3. æ±ç”¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦APIã‚’å‘¼ã³å‡ºã™ï¼ˆå†…éƒ¨ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚å®Ÿè¡Œï¼‰
    // updateActionã¯ä¾‹å¤–ã‚’æŠ•ã’ã‚‹è¨­è¨ˆã®ãŸã‚ã€ã“ã“ã§ã‚­ãƒ£ãƒƒãƒã—ã¦ActionStateã«å¤‰æ›
    const validatedResponse = await updateAction(
      `https://api.example.com/users/${userId}`,
      formInput,
      userFormInputToApiRequest,
      createUserApiSchema,
      userApiSchema,
      'PUT'
    );

    // 4. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–
    revalidatePath(`/users/${userId}/edit`);

    return { success: true };
  } catch (error) {
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: ä¾‹å¤–ã‚’ActionStateã«å¤‰æ›
    // æ­£å¸¸ç³»ã¯çœŸã£ç›´ãã€ç•°å¸¸ç³»ã¯ä¾‹å¤–ã§è½ã¨ã™è¨­è¨ˆã®ãŸã‚ã€ã“ã“ã§çµ±ä¸€ã—ã¦å‡¦ç†
    if (error instanceof Error) {
      // Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã®å ´åˆ
      if (error.message.includes('validation') || error.name === 'ZodError') {
        const errors: ActionState['errors'] = {
          general: 'å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚å†åº¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
        };
        return { errors };
      }
      return {
        errors: {
          general: error.message || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ',
        },
      };
    }
    return {
      errors: {
        general: 'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
      },
    };
  }
}
```

### ä»–ã®å‹ã§ã®ä½¿ç”¨ä¾‹ï¼ˆProductå‹ï¼‰

```typescript
// app/products/[id]/edit/actions.ts
'use server';

import { updateAction, createAction } from '@/utils/actionUtils';
import { productFormInputToApiRequest } from '@/components/ProductForm/schema';
import { createProductApiSchema } from '@/components/ProductForm/schema';
import { productApiSchema } from '@/api/schema/productSchema';
import { revalidatePath } from 'next/cache';
import type { ProductFormInput } from '@/components/ProductForm/schema';
import type { ProductApiResponse } from '@/api/schema/productSchema';

type ProductActionState = {
  errors?: {
    name?: string;
    price?: string;
    categoryId?: string;
    general?: string;
  };
  success?: boolean;
};

// å•†å“ä½œæˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³
export async function createProductAction(
  prevState: ProductActionState | null,
  formData: FormData
): Promise<ProductActionState> {
  const name = formData.get('name') as string;
  const price = Number(formData.get('price'));
  const categoryId = Number(formData.get('categoryId'));

  const formInput: ProductFormInput = {
    name,
    price,
    categoryId,
  };

  try {
    await createAction(
      'https://api.example.com/products',
      formInput,
      productFormInputToApiRequest,
      createProductApiSchema,
      productApiSchema
    );

    revalidatePath('/products');
    return { success: true };
  } catch (error) {
    return {
      errors: {
        general: error instanceof Error ? error.message : 'å•†å“ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ',
      },
    };
  }
}

// å•†å“æ›´æ–°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
export async function updateProductAction(
  prevState: ProductActionState | null,
  formData: FormData
): Promise<ProductActionState> {
  const productId = Number(formData.get('productId'));
  const name = formData.get('name') as string;
  const price = Number(formData.get('price'));
  const categoryId = Number(formData.get('categoryId'));

  const formInput: ProductFormInput = {
    name,
    price,
    categoryId,
  };

  try {
    await updateAction(
      `https://api.example.com/products/${productId}`,
      formInput,
      productFormInputToApiRequest,
      createProductApiSchema,
      productApiSchema,
      'PUT'
    );

    revalidatePath(`/products/${productId}/edit`);
    return { success: true };
  } catch (error) {
    return {
      errors: {
        general: error instanceof Error ? error.message : 'å•†å“ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ',
      },
    };
  }
}
```

### Client Componentã§ã®å®Ÿè£…ï¼ˆuseActionStateä½¿ç”¨ï¼‰

```typescript
// components/UserForm/UserForm.tsx
'use client';

import { useActionState } from 'react';
import { updateUserAction } from '@/app/users/[id]/edit/actions';

type UserFormProps = {
  initialValues: {
    firstName: string;
    lastName: string;
    email: string;
  };
  userId: number;
};

export default function UserForm({
  initialValues,
  userId,
}: UserFormProps) {
  // useActionStateã§Server Actionã®çŠ¶æ…‹ã‚’ç®¡ç†
  // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ—¢ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€ãªã©ï¼‰ã‚’UIã«è¿”ã™
  const [state, action, isPending] = useActionState(updateUserAction, null);

  return (
    <form action={action}>
      {/* userIdã‚’hidden inputã§é€ä¿¡ */}
      <input type="hidden" name="userId" value={userId} />
      
      <div>
        <label htmlFor="firstName">åå‰</label>
        <input
          id="firstName"
          name="firstName"
          defaultValue={initialValues.firstName}
          aria-invalid={state?.errors?.firstName ? 'true' : 'false'}
        />
        {state?.errors?.firstName && (
          <span role="alert" className="error">
            {state.errors.firstName}
          </span>
        )}
      </div>

      <div>
        <label htmlFor="lastName">å§“</label>
        <input
          id="lastName"
          name="lastName"
          defaultValue={initialValues.lastName}
          aria-invalid={state?.errors?.lastName ? 'true' : 'false'}
        />
        {state?.errors?.lastName && (
          <span role="alert" className="error">
            {state.errors.lastName}
          </span>
        )}
      </div>

      <div>
        <label htmlFor="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
        <input
          id="email"
          type="email"
          name="email"
          defaultValue={initialValues.email}
          aria-invalid={state?.errors?.email ? 'true' : 'false'}
        />
        {state?.errors?.email && (
          <span role="alert" className="error">
            {state.errors.email}
          </span>
        )}
      </div>

      {state?.errors?.general && (
        <div role="alert" className="error">
          {state.errors.general}
        </div>
      )}

      {state?.success && (
        <div className="success">ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ</div>
      )}

      <button type="submit" disabled={isPending}>
        {isPending ? 'é€ä¿¡ä¸­...' : 'é€ä¿¡'}
      </button>
    </form>
  );
}
```

### React Hook Formã¨useActionStateã®çµ„ã¿åˆã‚ã›ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

React Hook Formã‚’ä½¿ã„ãŸã„å ´åˆã§ã‚‚ã€useActionStateã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

```typescript
// components/UserForm/UserFormWithRHF.tsx
'use client';

import { useActionState } from 'react';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { userFormSchema, type UserFormInput } from './schema';
import { updateUserAction } from '@/app/users/[id]/edit/actions';

type UserFormProps = {
  initialValues: UserFormInput;
  userId: number;
};

export default function UserFormWithRHF({
  initialValues,
  userId,
}: UserFormProps) {
  const [state, formAction, isPending] = useActionState(updateUserAction, null);

  const {
    register,
    handleSubmit,
    formState: { errors: clientErrors },
  } = useForm<UserFormInput>({
    resolver: zodResolver(userFormSchema),
    defaultValues: initialValues,
  });

  const onSubmit = handleSubmit((data) => {
    // FormDataã‚’ä½œæˆã—ã¦Server Actionã«é€ä¿¡
    const formData = new FormData();
    formData.append('userId', userId.toString());
    formData.append('firstName', data.firstName);
    formData.append('lastName', data.lastName);
    formData.append('email', data.email);
    formAction(formData);
  });

  return (
    <form onSubmit={onSubmit}>
      <div>
        <label htmlFor="firstName">åå‰</label>
        <input id="firstName" {...register('firstName')} />
        {clientErrors.firstName && (
          <span role="alert">{clientErrors.firstName.message}</span>
        )}
        {state?.errors?.firstName && (
          <span role="alert">{state.errors.firstName}</span>
        )}
      </div>

      <div>
        <label htmlFor="lastName">å§“</label>
        <input id="lastName" {...register('lastName')} />
        {clientErrors.lastName && (
          <span role="alert">{clientErrors.lastName.message}</span>
        )}
        {state?.errors?.lastName && (
          <span role="alert">{state.errors.lastName}</span>
        )}
      </div>

      <div>
        <label htmlFor="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
        <input id="email" type="email" {...register('email')} />
        {clientErrors.email && (
          <span role="alert">{clientErrors.email.message}</span>
        )}
        {state?.errors?.email && (
          <span role="alert">{state.errors.email}</span>
        )}
      </div>

      {state?.errors?.general && (
        <div role="alert">{state.errors.general}</div>
      )}

      {state?.success && <div>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ</div>}

      <button type="submit" disabled={isPending}>
        {isPending ? 'é€ä¿¡ä¸­...' : 'é€ä¿¡'}
      </button>
    </form>
  );
}
```

---

## ğŸ ã¾ã¨ã‚

ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã®è©³ç´°ãªèª¬æ˜ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®å…¨ä½“åƒã€å„å±¤ã®è²¬å‹™ã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«ã¤ã„ã¦ã¯ã€[è¨­è¨ˆã‚¬ã‚¤ãƒ‰ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ](../../../../è¨­è¨ˆã‚¬ã‚¤ãƒ‰/02_apiè¨­è¨ˆ/04_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

Reactã§ã®å®Ÿè£…ä¾‹ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ](../../../Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/02_ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ.mdx)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### Next.jsï¼ˆApp Routerï¼‰ã§ã®ãƒã‚¤ãƒ³ãƒˆ

1. **Next.js 15ã®paramsã¯Promise**: `params`ã¯Next.js 15ä»¥é™ã§ã¯`Promise`å‹ã§ã€`await params`ãŒå¿…è¦ã§ã™ã€‚`const { id } = await params;`ã®ã‚ˆã†ã«å¿…ãšawaitã—ã¦ãã ã•ã„ã€‚
2. **useActionStateã®æ´»ç”¨**: ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ—¢ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€ãªã©ï¼‰ã‚’UIã«è¿”ã™ãŸã‚ã«ã€Reactå…¬å¼ã®`useActionState`ï¼ˆæ—§`useFormState`ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Server Actionã¯ã‚¨ãƒ©ãƒ¼ã‚’throwã™ã‚‹ã®ã§ã¯ãªãã€ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ã€‚
3. **ã€Œé€†æ–¹å‘ã€ã®æ´—æµ„**: APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã‚‰ã†æ™‚ã¯`zod.parse`ã—ã¦ã„ã¾ã™ãŒã€**APIã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ã‚‹ç›´å‰ã«ã‚‚`zod.parse`ã§æ´—æµ„**ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€DTOã‹ã‚‰ãƒ•ã‚©ãƒ¼ãƒ ã«å¤‰æ›ã—ãŸéš›ã®ã‚´ãƒŸãƒ‡ãƒ¼ã‚¿ãŒAPIã«é£›ã¶ã®ã‚’é˜²ã’ã¾ã™ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ä¸Šä½å±¤ï¼ˆServer Actionã®å…±é€šã‚­ãƒ£ãƒƒãƒæ©Ÿæ§‹ã€ErrorBoundaryï¼‰ã§å‡¦ç†ã—ã¾ã™ã€‚
4. **Server Componentsã®æ´»ç”¨**: ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€å‹å¤‰æ›ã‚’è¡Œã†
5. **Server Actionsã®æ´»ç”¨**: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚’Server Actionã§å‡¦ç†ã—ã€å‹å®‰å…¨æ€§ã‚’ä¿ã¤ï¼ˆ`'use server'`ã¯é–¢æ•°ã®å…ˆé ­ã«è¨˜è¿°ï¼‰
6. **Client Componentsã¨ã®åˆ†é›¢**: ãƒ•ã‚©ãƒ¼ãƒ ãªã©ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªéƒ¨åˆ†ã¯`'use client'`ã§Client Componentã¨ã—ã¦å®Ÿè£…
7. **MSWã¨ã®é€£æº**: é–‹ç™ºç’°å¢ƒã§ã¯[MSWï¼ˆãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰](../../../../è¨­è¨ˆã‚¬ã‚¤ãƒ‰/02_apiè¨­è¨ˆ/05_msw_ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼)ã‚’ä½¿ç”¨ã—ã¦APIã‚’ãƒ¢ãƒƒã‚¯

ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆã‚’å®ˆã‚‹ã“ã¨ã§ã€APIã¨UIã®è²¬å‹™ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã€ä¿å®ˆæ€§ã®é«˜ã„Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚
