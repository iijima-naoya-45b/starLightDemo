---
title: "Next.jsã®ORM"
label: "Next.jsã®ORM"
---

## ğŸ—„ï¸ Next.jsã®ORM

Next.jsã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã«ã¯ã€ORMï¼ˆObject-Relational Mappingï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®ã‚„ã‚Šå–ã‚Šã‚’ç°¡ç´ åŒ–ã—ã€ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¨ä¿å®ˆæ€§ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã“ã§ã¯ã€Prismaã‚’ä¾‹ã«ã¨ã£ã¦ã€Next.jsã§ã®ORMã®ä½¿ç”¨æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

### 1. Prismaã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

Prismaã¯ã€Next.jsã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹å¼·åŠ›ãªORMã§ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§Prismaã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install @prisma/client
npm install prisma --save-dev
```

#### Prismaã®åˆæœŸåŒ–

```bash
npx prisma init
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Prismaã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«`prisma/schema.prisma`ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©

`prisma/schema.prisma`ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ã¾ã™ã€‚

```prisma
// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id    Int    @id @default(autoincrement())
  name  String
  email String @unique
}
```

### 3. Prisma Clientã®ç”Ÿæˆ

ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã—ãŸã‚‰ã€Prisma Clientã‚’ç”Ÿæˆã—ã¾ã™ã€‚

```bash
npx prisma generate
```

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ

Prisma Clientã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚’è¡Œã„ã¾ã™ã€‚

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆ

```typescript
// pages/api/users.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export default async function handler(req, res) {
  if (req.method === 'POST') {
    const { name, email } = req.body;
    const user = await prisma.user.create({
      data: {
        name,
        email,
      },
    });
    res.status(201).json(user);
  } else {
    res.status(405).json({ message: 'Method Not Allowed' });
  }
}
```

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å–å¾—

```typescript
// pages/api/users/[id].ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export default async function handler(req, res) {
  const { id } = req.query;
  const user = await prisma.user.findUnique({
    where: { id: Number(id) },
  });
  res.status(200).json(user);
}
```

Prismaã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œãŒç°¡å˜ã«ãªã‚Šã€ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¨ä¿å®ˆæ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚
