---
title: "Next.jsのルーティング"
label: "Next.jsのルーティング"
---

## 🛤️ Next.jsのルーティング（App RouterとPages Router）

Next.jsは、ファイルシステムに基づいたルーティングを採用しています。これにより、プロジェクト内のディレクトリやファイルがそのままURLパスになります。Next.js 13以降、新しいApp Routerが導入され、既存のPages Routerと異なるアプローチでルーティングを管理します。

### 1. App Routerによるルーティング

App Routerは、`app/`ディレクトリを使用してルーティングを管理します。このアプローチでは、レイアウトの共有、ストリーミング、サーバーコンポーネントの利用が容易になります。

#### ファイルベースのルーティング (`app/`)

`app/`ディレクトリ内のサブディレクトリがURLパスに対応します。各セグメントの`page.tsx`ファイルが、そのパスのUIを定義します。

```
/app
├── layout.tsx         // 共有レイアウト（例: ナビゲーションバー）
├── page.tsx           // ルートページ (/)
├── about/
│   └── page.tsx       // /aboutページ
└── blog/
    └── [slug]/
        └── page.tsx   // /blog/[slug]ページ
```

#### 動的ルーティング (TypeScript)

動的なパスセグメントは、角括弧`[]`で囲んで指定します。例えば、`[slug]`というディレクトリは、`/blog/first-post`や`/blog/second-post`のようなURLに対応します。

##### 例: `app/blog/[slug]/page.tsx`

```typescript
// app/blog/[slug]/page.tsx
type BlogPostPageProps = {
  params: {
    slug: string;
  };
};

const BlogPostPage = ({ params }: BlogPostPageProps) => {
  return <h1>ブログ投稿: {params.slug}</h1>;
};

export default BlogPostPage;
```

- `params`: App Routerでは、動的なセグメントの値が`params`プロパティとしてコンポーネントに渡されます。これにより、`useRouter`フックを使用する必要がなくなります。

### 2. Pages Routerによるルーティング

Pages Routerは、`pages/`ディレクトリを使用してルーティングを管理する従来のアプローチです。

#### ファイルベースのルーティング (`pages/`)

`pages/`ディレクトリ内のファイル名がURLパスになります。

```
/pages
├── index.tsx          // ルートページ (/)
├── about.tsx          // /aboutページ
└── blog/
    └── [id].tsx       // /blog/[id]ページ
```

#### 動的ルーティング (TypeScript)

Pages Routerでは、`useRouter`フックを使って動的なセグメントの値を取得します。

##### 例: `pages/blog/[id].tsx`

```typescript
// pages/blog/[id].tsx
import { useRouter } from 'next/router';

const BlogPostPage = () => {
  const router = useRouter();
  const { id } = router.query;

  return <h1>ブログ投稿: {id}</h1>;
};

export default BlogPostPage;
```

- `useRouter`: クライアントサイドでのルーティング情報（URL、クエリパラメータなど）にアクセスするためのフックです。

### まとめ

| 特徴             | Pages Router | App Router |
|------------------|--------------|------------|
| ディレクトリ     | `pages/`     | `app/`     |
| 動的セグメント   | `[name].tsx` | `[name]/page.tsx` |
| パス取得         | `useRouter().query` | `params`プロパティ |
| 利点             | シンプルで理解しやすい | レイアウト共有、サーバーコンポーネント、高度な機能 |

新しいプロジェクトを始める場合は、**App Router**の利用が強く推奨されます。App Routerは、将来的なNext.jsの進化の方向性であり、サーバーコンポーネントやデータフェッチの新しい方法など、多くのパフォーマンス改善を提供します。
