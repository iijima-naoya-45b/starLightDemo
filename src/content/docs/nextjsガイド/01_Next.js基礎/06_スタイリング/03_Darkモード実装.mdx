---
title: Darkãƒ¢ãƒ¼ãƒ‰å®Ÿè£…ï¼ˆTailwind CSSï¼‰
sidebar:
    label: Darkãƒ¢ãƒ¼ãƒ‰å®Ÿè£…
---

# Next.js/Reactã§ã®Darkãƒ¢ãƒ¼ãƒ‰å®Ÿè£…ï¼ˆTailwind CSSï¼‰

Tailwind CSSã‚’ä½¿ç”¨ã—ã¦ã€Next.jsã‚„Reactã‚¢ãƒ—ãƒªã«darkãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚

## 1. Tailwind CSSã®è¨­å®š

### tailwind.config.jsã®è¨­å®š

```javascript
// tailwind.config.js
/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: 'class', // 'media' ã¾ãŸã¯ 'class' ã‚’æŒ‡å®š
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

**è¨­å®šã®é•ã„:**
- `'media'`: ã‚·ã‚¹ãƒ†ãƒ ã®è¨­å®šï¼ˆprefers-color-schemeï¼‰ã«è‡ªå‹•çš„ã«å¾“ã†
- `'class'`: HTMLè¦ç´ ã®`class`å±æ€§ã§æ‰‹å‹•åˆ¶å¾¡ï¼ˆæ¨å¥¨ï¼‰

## 2. Next.jsã§ã®å®Ÿè£…ï¼ˆApp Routerï¼‰

### ThemeProviderã®ä½œæˆ

```typescript
// app/providers/theme-provider.tsx
'use client'

import { createContext, useContext, useEffect, useState } from 'react'

type Theme = 'dark' | 'light' | 'system'

type ThemeProviderProps = {
  children: React.ReactNode
  defaultTheme?: Theme
  storageKey?: string
}

type ThemeProviderState = {
  theme: Theme
  setTheme: (theme: Theme) => void
}

const initialState: ThemeProviderState = {
  theme: 'system',
  setTheme: () => null,
}

const ThemeProviderContext = createContext<ThemeProviderState>(initialState)

export function ThemeProvider({
  children,
  defaultTheme = 'system',
  storageKey = 'vite-ui-theme',
  ...props
}: ThemeProviderProps) {
  const [theme, setTheme] = useState<Theme>(
    () => (typeof window !== 'undefined' && localStorage.getItem(storageKey)) as Theme || defaultTheme
  )

  useEffect(() => {
    const root = window.document.documentElement

    root.classList.remove('light', 'dark')

    if (theme === 'system') {
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)')
        .matches
        ? 'dark'
        : 'light'

      root.classList.add(systemTheme)
      return
    }

    root.classList.add(theme)
  }, [theme])

  const value = {
    theme,
    setTheme: (theme: Theme) => {
      localStorage.setItem(storageKey, theme)
      setTheme(theme)
    },
  }

  return (
    <ThemeProviderContext.Provider {...props} value={value}>
      {children}
    </ThemeProviderContext.Provider>
  )
}

export const useTheme = () => {
  const context = useContext(ThemeProviderContext)

  if (context === undefined)
    throw new Error('useTheme must be used within a ThemeProvider')

  return context
}
```

### layout.tsxã§ã®è¨­å®š

```typescript
// app/layout.tsx
import { ThemeProvider } from './providers/theme-provider'

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ja" suppressHydrationWarning>
      <body>
        <ThemeProvider
          defaultTheme="system"
          storageKey="app-theme"
        >
          {children}
        </ThemeProvider>
      </body>
    </html>
  )
}
```

### ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// components/theme-toggle.tsx
'use client'

import { useTheme } from '@/app/providers/theme-provider'
import { Moon, Sun } from 'lucide-react'

export function ThemeToggle() {
  const { theme, setTheme } = useTheme()

  return (
    <button
      onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}
      className="fixed bottom-4 right-4 p-3 rounded-full bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
      aria-label="Toggle theme"
    >
      {theme === 'dark' ? (
        <Sun className="h-5 w-5 text-yellow-500" />
      ) : (
        <Moon className="h-5 w-5 text-gray-700" />
      )}
    </button>
  )
}
```

### ä½¿ç”¨ä¾‹

```typescript
// app/page.tsx
import { ThemeToggle } from '@/components/theme-toggle'

export default function Home() {
  return (
    <div className="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
      <div className="container mx-auto px-4 py-8">
        <h1 className="text-4xl font-bold mb-4">
          Dark Mode Example
        </h1>
        <p className="text-lg mb-8">
          ã“ã®ãƒšãƒ¼ã‚¸ã¯darkãƒ¢ãƒ¼ãƒ‰ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
        </p>
        <ThemeToggle />
      </div>
    </div>
  )
}
```

## 3. Next.jsã§ã®å®Ÿè£…ï¼ˆPages Routerï¼‰

### _app.tsxã§ã®è¨­å®š

```typescript
// pages/_app.tsx
import { ThemeProvider } from '@/contexts/theme-context'
import type { AppProps } from 'next/app'
import { useEffect, useState } from 'react'

export default function App({ Component, pageProps }: AppProps) {
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
  }, [])

  if (!mounted) {
    return null
  }

  return (
    <ThemeProvider>
      <Component {...pageProps} />
    </ThemeProvider>
  )
}
```

### ThemeContextã®ä½œæˆ

```typescript
// contexts/theme-context.tsx
import { createContext, useContext, useEffect, useState } from 'react'

type Theme = 'dark' | 'light'

type ThemeContextType = {
  theme: Theme
  toggleTheme: () => void
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined)

export function ThemeProvider({ children }: { children: React.ReactNode }) {
  const [theme, setTheme] = useState<Theme>('light')
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
    const savedTheme = localStorage.getItem('theme') as Theme | null
    if (savedTheme) {
      setTheme(savedTheme)
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      setTheme('dark')
    }
  }, [])

  useEffect(() => {
    if (mounted) {
      const root = document.documentElement
      root.classList.remove('light', 'dark')
      root.classList.add(theme)
      localStorage.setItem('theme', theme)
    }
  }, [theme, mounted])

  const toggleTheme = () => {
    setTheme(prev => prev === 'dark' ? 'light' : 'dark')
  }

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  )
}

export function useTheme() {
  const context = useContext(ThemeContext)
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider')
  }
  return context
}
```

## 4. Reactï¼ˆViteï¼‰ã§ã®å®Ÿè£…

### ThemeProviderã®ä½œæˆ

```typescript
// src/contexts/ThemeContext.tsx
import { createContext, useContext, useEffect, useState, ReactNode } from 'react'

type Theme = 'dark' | 'light'

interface ThemeContextType {
  theme: Theme
  toggleTheme: () => void
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined)

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState<Theme>(() => {
    if (typeof window !== 'undefined') {
      const saved = localStorage.getItem('theme')
      if (saved) {
        return saved as Theme
      }
      return window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light'
    }
    return 'light'
  })

  useEffect(() => {
    const root = document.documentElement
    root.classList.remove('light', 'dark')
    root.classList.add(theme)
    localStorage.setItem('theme', theme)
  }, [theme])

  const toggleTheme = () => {
    setTheme(prev => prev === 'dark' ? 'light' : 'dark')
  }

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  )
}

export function useTheme() {
  const context = useContext(ThemeContext)
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider')
  }
  return context
}
```

### main.tsxã§ã®è¨­å®š

```typescript
// src/main.tsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'
import { ThemeProvider } from './contexts/ThemeContext.tsx'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <ThemeProvider>
      <App />
    </ThemeProvider>
  </React.StrictMode>,
)
```

### ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// src/components/ThemeToggle.tsx
import { useTheme } from '../contexts/ThemeContext'

export function ThemeToggle() {
  const { theme, toggleTheme } = useTheme()

  return (
    <button
      onClick={toggleTheme}
      className="p-2 rounded-lg bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
      aria-label="Toggle theme"
    >
      {theme === 'dark' ? (
        <span className="text-yellow-500">â˜€ï¸</span>
      ) : (
        <span className="text-gray-700">ğŸŒ™</span>
      )}
    </button>
  )
}
```

## 5. Tailwind CSSã®darkãƒ¢ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¹

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

```typescript
// dark:ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨
<div className="bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
  <h1 className="text-2xl font-bold">ã‚¿ã‚¤ãƒˆãƒ«</h1>
  <p className="text-gray-600 dark:text-gray-400">èª¬æ˜æ–‡</p>
</div>
```

### ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³

```typescript
// èƒŒæ™¯è‰²
className="bg-white dark:bg-gray-900"

// ãƒ†ã‚­ã‚¹ãƒˆè‰²
className="text-gray-900 dark:text-white"

// ãƒœãƒ¼ãƒ€ãƒ¼
className="border-gray-200 dark:border-gray-700"

// ãƒ›ãƒãƒ¼åŠ¹æœ
className="hover:bg-gray-100 dark:hover:bg-gray-800"

// ã‚·ãƒ£ãƒ‰ã‚¦
className="shadow-lg dark:shadow-gray-900/50"
```

## 6. å®Ÿå‹™ã§ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã«å¾“ã†

```typescript
// ã‚·ã‚¹ãƒ†ãƒ ã®è¨­å®šã‚’ç›£è¦–
useEffect(() => {
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)')
  
  const handleChange = (e: MediaQueryListEvent) => {
    setTheme(e.matches ? 'dark' : 'light')
  }
  
  mediaQuery.addEventListener('change', handleChange)
  return () => mediaQuery.removeEventListener('change', handleChange)
}, [])
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ

```typescript
// hooks/useDarkMode.ts
import { useEffect, useState } from 'react'

export function useDarkMode() {
  const [theme, setTheme] = useState<'dark' | 'light'>('light')
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
    const savedTheme = localStorage.getItem('theme')
    if (savedTheme) {
      setTheme(savedTheme as 'dark' | 'light')
    }
  }, [])

  useEffect(() => {
    if (mounted) {
      document.documentElement.classList.toggle('dark', theme === 'dark')
      localStorage.setItem('theme', theme)
    }
  }, [theme, mounted])

  return [theme, setTheme, mounted] as const
}
```

## 7. ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–

### å•é¡Œ1: ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆFOUC: Flash of Unstyled Contentï¼‰

**è§£æ±ºç­–**: `suppressHydrationWarning`ã‚’ä½¿ç”¨

```typescript
<html lang="ja" suppressHydrationWarning>
```

### å•é¡Œ2: ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ã®ã‚¨ãƒ©ãƒ¼

**è§£æ±ºç­–**: `mounted`çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯

```typescript
const [mounted, setMounted] = useState(false)

useEffect(() => {
  setMounted(true)
}, [])

if (!mounted) {
  return null // ã¾ãŸã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®UI
}
```

### å•é¡Œ3: ãƒ†ãƒ¼ãƒãŒä¿å­˜ã•ã‚Œãªã„

**è§£æ±ºç­–**: `localStorage`ã®ä½¿ç”¨ã‚’ç¢ºèª

```typescript
useEffect(() => {
  if (typeof window !== 'undefined') {
    localStorage.setItem('theme', theme)
  }
}, [theme])
```

ã“ã‚Œã§ã€Next.jsã‚„Reactã‚¢ãƒ—ãƒªã§Tailwind CSSã‚’ä½¿ç”¨ã—ãŸdarkãƒ¢ãƒ¼ãƒ‰å®Ÿè£…ãŒå®Œäº†ã—ã¾ã™ã€‚

