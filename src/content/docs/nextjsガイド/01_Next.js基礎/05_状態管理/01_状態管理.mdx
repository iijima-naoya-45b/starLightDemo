---
title: "çŠ¶æ…‹ç®¡ç†.mdx"
label: "çŠ¶æ…‹ç®¡ç†.mdx"
---

> **ğŸ“š Reactã®åŸºç¤ã«ã¤ã„ã¦**: åŸºæœ¬çš„ãªReactã®æ¦‚å¿µï¼ˆuseStateã€useEffectã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Propsã€Context APIãªã©ï¼‰ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰](/Reactã‚¬ã‚¤ãƒ‰/01_ReactåŸºç¤)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Next.jsã§ã®çŠ¶æ…‹ç®¡ç†ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚

## âš›ï¸ çŠ¶æ…‹ç®¡ç†ã¨ã¯

> **ğŸ“š Reactã®åŸºç¤ã«ã¤ã„ã¦**: åŸºæœ¬çš„ãªReactã®æ¦‚å¿µï¼ˆuseStateã€useEffectã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Propsãªã©ï¼‰ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰](/Reactã‚¬ã‚¤ãƒ‰/01_ReactåŸºç¤)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Next.jsã§ã®çŠ¶æ…‹ç®¡ç†ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚

çŠ¶æ…‹ç®¡ç†ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€å…ƒçš„ã«ç®¡ç†ã—ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã§å…±æœ‰ãƒ»æ›´æ–°ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ„ãƒªãƒ¼ã‚’æ·±ãè¾¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™**ã€ŒProps Drillingã€**ã®å•é¡ŒãŒè§£æ±ºã•ã‚Œã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãŒäºˆæ¸¬å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

### ãªãœçŠ¶æ…‹ç®¡ç†ãŒé‡è¦ãªã®ã‹

#### Props Drillingã®å•é¡Œ

> **ğŸ“š Props Drillingã®è©³ç´°**: Props Drillingã®å•é¡Œã¨Context APIã«ã‚ˆã‚‹è§£æ±ºæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰:**

```typescript
// å•é¡Œ: Propsã‚’ä½•å±¤ã«ã‚‚æ¸¡ã™å¿…è¦ãŒã‚ã‚‹
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
function App() {
  const [user, setUser] = useState(null);
  
  return <Layout user={user} setUser={setUser} />;
}

function Layout({ user, setUser }: { user: User | null; setUser: (user: User) => void }) {
  return <Header user={user} setUser={setUser} />;
}

function Header({ user, setUser }: { user: User | null; setUser: (user: User) => void }) {
  return <UserMenu user={user} setUser={setUser} />;
}

function UserMenu({ user, setUser }: { user: User | null; setUser: (user: User) => void }) {
  // ã‚ˆã†ã‚„ãä½¿ç”¨ã§ãã‚‹
  return <div>{user?.name}</div>;
}

// å•é¡Œç‚¹:
// - ä¸­é–“ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒä¸è¦ãªpropsã‚’å—ã‘å–ã‚‹
// - ã‚³ãƒ¼ãƒ‰ãŒå†—é•·ã«ãªã‚‹
// - å‹å®šç¾©ãŒè¤‡é›‘ã«ãªã‚‹
// - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå›°é›£
```

**è§£æ±º: çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨**

```typescript
// è§£æ±º: Zustandã‚’ä½¿ç”¨
import { create } from 'zustand';

interface UserStore {
  user: User | null;
  setUser: (user: User) => void;
}

const useUserStore = create<UserStore>((set) => ({
  user: null,
  setUser: (user) => set({ user }),
}));

// ã©ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã§ã‚‚ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
function UserMenu() {
  const user = useUserStore((state) => state.user);
  return <div>{user?.name}</div>;
}
```

#### çŠ¶æ…‹ç®¡ç†ã®æœ¬è³ªçš„ãªä¾¡å€¤

**1. ãƒ‡ãƒ¼ã‚¿ã®å˜ä¸€ã®çœŸå®Ÿã®æºï¼ˆSingle Source of Truthï¼‰**

> **ğŸ“š useStateã®è©³ç´°**: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®useStateã¨useEffect](/Reactã‚¬ã‚¤ãƒ‰/01_ReactåŸºç¤/03_ãƒ•ãƒƒã‚¯/01_useStateã¨useEffect)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

```typescript
// å•é¡Œ: çŠ¶æ…‹ãŒè¤‡æ•°ã®å ´æ‰€ã«æ•£åœ¨
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
function ComponentA() {
  const [cart, setCart] = useState([]);
  // ...
}

function ComponentB() {
  const [cart, setCart] = useState([]);  // åŒã˜çŠ¶æ…‹ãŒé‡è¤‡
  // ...
}

// è§£æ±º: ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã§ä¸€å…ƒç®¡ç†
const useCartStore = create((set) => ({
  items: [],
  addItem: (item) => set((state) => ({ items: [...state.items, item] })),
}));

// ã™ã¹ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒåŒã˜çŠ¶æ…‹ã‚’å‚ç…§
function ComponentA() {
  const items = useCartStore((state) => state.items);
  // ...
}

function ComponentB() {
  const items = useCartStore((state) => state.items);  // åŒã˜çŠ¶æ…‹
  // ...
}
```

**2. äºˆæ¸¬å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**

> **ğŸ“š useEffectã®è©³ç´°**: useEffectã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®useStateã¨useEffect](/Reactã‚¬ã‚¤ãƒ‰/01_ReactåŸºç¤/03_ãƒ•ãƒƒã‚¯/01_useStateã¨useEffect)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

```typescript
// å•é¡Œ: çŠ¶æ…‹ã®æ›´æ–°ãŒäºˆæ¸¬å›°é›£
// æ³¨æ„: useStateã¨useEffectã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
function Component() {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    // è¤‡æ•°ã®å ´æ‰€ã§çŠ¶æ…‹ã‚’æ›´æ–°
    fetchData1().then(setData);
    fetchData2().then(setData);  // ç«¶åˆçŠ¶æ…‹ã®å¯èƒ½æ€§
  }, []);
}

// è§£æ±º: ä¸€å…ƒåŒ–ã•ã‚ŒãŸæ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯
const useDataStore = create((set) => ({
  data: null,
  fetchData: async () => {
    const data1 = await fetchData1();
    const data2 = await fetchData2();
    set({ data: { ...data1, ...data2 } });  // äºˆæ¸¬å¯èƒ½ãªæ›´æ–°
  },
}));
```

**3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

```typescript
// å•é¡Œ: ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
function ExpensiveComponent({ user }: { user: User }) {
  // userãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
  return <ExpensiveRender user={user} />;
}

// è§£æ±º: å¿…è¦ãªéƒ¨åˆ†ã ã‘ã‚’è³¼èª­
function ExpensiveComponent() {
  // user.nameã ã‘ã‚’è³¼èª­ï¼ˆuserã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®å¤‰æ›´ã«ã¯åå¿œã—ãªã„ï¼‰
  const userName = useUserStore((state) => state.user?.name);
  return <ExpensiveRender userName={userName} />;
}
```

### 1. Zustand

Zustandã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ã§ãƒŸãƒ‹ãƒãƒªã‚¹ãƒˆãªçŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ãƒ•ãƒƒã‚¯APIã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ãŠã‚Šã€ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆãŒéå¸¸ã«å°‘ãªã„ã®ãŒç‰¹å¾´ã§ã™ã€‚

- **ç‰¹å¾´**: å°‘ãªã„ã‚³ãƒ¼ãƒ‰ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã‚’ä½œæˆã§ãã€`useStore`ãƒ•ãƒƒã‚¯ã§å¿…è¦ãªçŠ¶æ…‹ã ã‘ã‚’ç°¡å˜ã«å–å¾—ã§ãã¾ã™ã€‚

### 2. Redux

Reduxã¯ã€å¤§è¦æ¨¡ã§è¤‡é›‘ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‘ã‘ã®çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚**ã€Œå˜ä¸€æ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã€**ã«åŸºã¥ãã€å³æ ¼ãªãƒ«ãƒ¼ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ã‚’ç®¡ç†ã—ã¾ã™ã€‚

- **ç‰¹å¾´**: çŠ¶æ…‹ã®å¤‰æ›´ã‚’ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã‚’é€šã˜ã¦è¡Œã†ãŸã‚ã€äºˆæ¸¬å¯èƒ½æ€§ãŒé«˜ãã€ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“ã§ã™ã€‚ãŸã ã—ã€è¨­å®šãŒè¤‡é›‘ã«ãªã‚ŠãŒã¡ã§ã™ãŒã€Redux Toolkitã§ç°¡ç´ åŒ–ã§ãã¾ã™ã€‚

### 3. Recoil

Recoilã¯ã€Reactã®æ€æƒ³ã«è¿‘ã„çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€çŠ¶æ…‹ã‚’**ã€ŒAtomã€**ã¨ã„ã†å°ã•ãªå˜ä½ã«åˆ†å‰²ã—ã¦ç®¡ç†ã—ã¾ã™ã€‚

- **ç‰¹å¾´**: `useState`ã«ä¼¼ãŸæ„Ÿè¦šã§ä½¿ãˆã€Atomï¼ˆæœ€å°å˜ä½ã®çŠ¶æ…‹ï¼‰ã¨Selectorï¼ˆAtomã‹ã‚‰æ´¾ç”Ÿã—ãŸçŠ¶æ…‹ï¼‰ã‚’é€šã˜ã¦ã€å¿…è¦ãªçŠ¶æ…‹ã ã‘ã‚’åŠ¹ç‡çš„ã«è³¼èª­ã§ãã¾ã™ã€‚

### 4. Jotai

Jotaiï¼ˆã‚¸ãƒ§ã‚¿ã‚¤ï¼‰ã¯ã€æ—¥æœ¬èªã®ã€ŒçŠ¶æ…‹ã€ã‹ã‚‰åä»˜ã‘ã‚‰ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€Recoilã¨åŒæ§˜ã«ã‚¢ãƒˆãƒŸãƒƒã‚¯ãªçŠ¶æ…‹ç®¡ç†ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

- **ç‰¹å¾´**: Recoilã‚ˆã‚Šã‚‚ã•ã‚‰ã«ãƒŸãƒ‹ãƒãƒªã‚¹ãƒˆãªAPIã‚’æä¾›ã—ã€`useState`ãƒ•ãƒƒã‚¯ã«éå¸¸ã«è¿‘ã„æ„Ÿè¦šã§ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã‚’æ‰±ãˆã¾ã™ã€‚ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ã§å°ã•ãªAtomã‚’çµ„ã¿åˆã‚ã›ã¦è¤‡é›‘ãªçŠ¶æ…‹ã‚’æ§‹ç¯‰ã™ã‚‹ã®ã«é©ã—ã¦ã„ã¾ã™ã€‚

### ã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é¸ã¶ã¹ãã‹ï¼Ÿ

| æ¯”è¼ƒé …ç›®     | Zustand       | Redux         | Recoil        | Jotai         |
|--------------|---------------|---------------|---------------|---------------|
| å­¦ç¿’ã‚³ã‚¹ãƒˆ   | éå¸¸ã«ä½ã„    | é«˜ã„          | ä½ã„          | éå¸¸ã«ä½ã„    |
| ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆ | éå¸¸ã«å°‘ãªã„  | å¤šã„          | å°‘ãªã„        | å°‘ãªã„        |
| è¦æ¨¡         | å°ã€œä¸­è¦æ¨¡    | å¤§è¦æ¨¡        | å°ã€œå¤§è¦æ¨¡    | å°ã€œå¤§è¦æ¨¡    |
| ã‚³ãƒ³ã‚»ãƒ—ãƒˆ   | ãƒ•ãƒƒã‚¯ãƒ™ãƒ¼ã‚¹  | å˜ä¸€æ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ | Atom & Selector | Atom & ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ— |

- **ã‚·ãƒ³ãƒ—ãƒ«ã•**: Zustandã¨Jotaiã¯ã€ç›´æ„Ÿçš„ã«ä½¿ã„å§‹ã‚ãŸã„å ´åˆã«æœ€é©ã§ã™ã€‚

- **å¤§è¦æ¨¡é–‹ç™º**: Reduxã¯ã€å³æ ¼ãªãƒ«ãƒ¼ãƒ«ã¨äºˆæ¸¬å¯èƒ½æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹å¤§è¦æ¨¡ãªã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å‘ã„ã¦ã„ã¾ã™ã€‚

- **Reactã¨ã®è¦ªå’Œæ€§**: Recoilã¨Jotaiã¯ã€ã‚¢ãƒˆãƒŸãƒƒã‚¯ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®Reacté–‹ç™ºã¨ç›¸æ€§ãŒè‰¯ã„ã§ã™ã€‚ç‰¹ã«Jotaiã¯ã€ã‚ˆã‚ŠãƒŸãƒ‹ãƒãƒ«ãªAPIã‚’å¥½ã‚€é–‹ç™ºè€…ã«ãŠã™ã™ã‚ã§ã™ã€‚

---

## çŠ¶æ…‹ç®¡ç†ã®ä¸‰æ¨©åˆ†ç«‹

çŠ¶æ…‹ç®¡ç†ã‚’ç†è§£ã™ã‚‹éš›ã€ä»¥ä¸‹ã®3ã¤ã®å½¹å‰²ã‚’ã€Œã©ã“ã«é…ç½®ã™ã‚‹ã‹ã€ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ãã‚Œãã‚Œã®å½¹å‰²ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€é©åˆ‡ãªçŠ¶æ…‹ç®¡ç†ã®é¸æŠãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

### 1. Local Stateï¼ˆãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ï¼‰: ãã®å ´é™ã‚Šã®ä½¿ã„æ¨ã¦

> **ğŸ“š useStateã®è©³ç´°**: useStateã®è©³ç´°ãªä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®useStateã¨useEffect](/Reactã‚¬ã‚¤ãƒ‰/01_ReactåŸºç¤/03_ãƒ•ãƒƒã‚¯/01_useStateã¨useEffect)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**å½¹å‰²:** `useState`ã‚’ä½¿ç”¨ã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã®çŠ¶æ…‹ç®¡ç†

**ç‰¹å¾´:**
- ãã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã®ã¿ä½¿ç”¨ã•ã‚Œã‚‹çŠ¶æ…‹
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ã¨ã€çŠ¶æ…‹ã‚‚ç ´æ£„ã•ã‚Œã‚‹
- æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ãŒæœ€å°é™

**ä½¿ç”¨ä¾‹:**

```typescript
// components/Counter.tsx
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
import { useState } from 'react';

function Counter() {
  // Local State: ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã®ã¿ä½¿ç”¨
  const [count, setCount] = useState(0);
  const [isOpen, setIsOpen] = useState(false);
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
      <button onClick={() => setIsOpen(!isOpen)}>Toggle</button>
    </div>
  );
}
```

**åˆ¤æ–­åŸºæº–:**
- 1ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã®ã¿ä½¿ç”¨ã•ã‚Œã‚‹
- ä»–ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨å…±æœ‰ã™ã‚‹å¿…è¦ãŒãªã„
- Props DrillingãŒ2å±¤ä»¥å†…ã§æ¸ˆã‚€å ´åˆã¯ã€Local Stateã§ååˆ†

### 2. Context API: ã€Œä¾å­˜æ€§ã®æ³¨å…¥ã€ã€‚çŠ¶æ…‹ãã®ã‚‚ã®ã‚ˆã‚Šã€å€¤ã‚’å¥¥æ·±ãã¾ã§å±Šã‘ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

> **ğŸ“š Context APIã®è©³ç´°**: Context APIã®è©³ç´°ãªä½¿ã„æ–¹ï¼ˆä½œæˆã€æä¾›ã€æ¶ˆè²»ã®3ã‚¹ãƒ†ãƒƒãƒ—ã€æ³¨æ„ç‚¹ãªã©ï¼‰ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**å½¹å‰²:** ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ„ãƒªãƒ¼å…¨ä½“ã§å€¤ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿

**ç‰¹å¾´:**
- çŠ¶æ…‹ã®ã€Œä¼é”ã€ã«ç‰¹åŒ–ã—ãŸä»•çµ„ã¿
- çŠ¶æ…‹ã‚’ä¿æŒã™ã‚‹ãŸã‚ã«ã¯ã€`useState`ã‚„`useReducer`ãŒå¿…è¦
- Contextã®å€¤ãŒæ›´æ–°ã•ã‚Œã‚‹ã¨ã€ãã®Contextã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹

**ä½¿ç”¨ä¾‹:**

> **ğŸ“š Context APIã®è©³ç´°**: Context APIã®è©³ç´°ãªä½¿ã„æ–¹ï¼ˆä½œæˆã€æä¾›ã€æ¶ˆè²»ã®3ã‚¹ãƒ†ãƒƒãƒ—ã€æ³¨æ„ç‚¹ãªã©ï¼‰ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

```typescript
// context/ThemeContext.tsx
// æ³¨æ„: Context APIã€useStateã€useContextã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
import { createContext, useContext, useState, ReactNode } from 'react';

type Theme = 'light' | 'dark';

interface ThemeContextType {
  theme: Theme;
  setTheme: (theme: Theme) => void;
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: ReactNode }) {
  // çŠ¶æ…‹ã®ä¿æŒã«ã¯useStateãŒå¿…è¦
  const [theme, setTheme] = useState<Theme>('light');
  
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
}
```

### 3. Server Stateï¼ˆã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ï¼‰: ã‚µãƒ¼ãƒãƒ¼ã®å½±ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ã€‚ã€Œä»Šã€æ‰‹å…ƒã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯æœ€æ–°ã‹ï¼Ÿã€ã‚’ç®¡ç†ã™ã‚‹å°‚é–€è·

**å½¹å‰²:** ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€å†å–å¾—ã‚„åŒæœŸã‚’ç®¡ç†

**ç‰¹å¾´:**
- APIã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€å†å–å¾—ã€åŒæœŸãŒè‡ªå‹•çš„ã«è¡Œã‚ã‚Œã‚‹
- TanStack Queryã‚„SWRãªã©ã®å°‚ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦

**ä½¿ç”¨ä¾‹:**

```typescript
// hooks/useUser.ts
import { useQuery } from '@tanstack/react-query';

function UserProfile({ userId }: { userId: string }) {
  // Server State: ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†
  const { data: user, isLoading, error } = useQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId),
    staleTime: 5 * 60 * 1000, // 5åˆ†é–“ã¯æ–°é®®ã¨ã¿ãªã™
  });
  
  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</div>;
  
  return <div>{user.name}</div>;
}
```

**åˆ¤æ–­åŸºæº–:**
- ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¿…è¦
- å†å–å¾—ãŒå¿…è¦
- åŒæœŸãŒå¿…è¦

---

## useContextã®ã¾ã•ã‹ã‚Šãƒã‚¤ãƒ³ãƒˆï¼šãã‚Œã¯ã€ŒçŠ¶æ…‹ç®¡ç†ã€ã§ã¯ãªã„

> **ğŸ“š Context APIã®è©³ç´°**: Context APIã®è©³ç´°ãªèª¬æ˜ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã‚ˆãã‚ã‚‹èª¤è§£ã§ã™ãŒã€**Context APIã¯å˜ä½“ã§ã¯ã€ŒçŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚

### ğŸ’¡ ã¾ã•ã‹ã‚Šãƒã‚¤ãƒ³ãƒˆ

**Contextã¯ã€Œå€¤ã‚’ä¼é”ã™ã‚‹ä»•çµ„ã¿ã€ã«éãã¾ã›ã‚“ã€‚** çŠ¶æ…‹ã®ä¿æŒã«ã¯çµå±€`useState`ã‚„`useReducer`ãŒå¿…è¦ã§ã™ã€‚

```typescript
// âŒ èª¤è§£: ContextãŒçŠ¶æ…‹ã‚’ä¿æŒã—ã¦ã„ã‚‹
// æ³¨æ„: Context APIã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
const ThemeContext = createContext(null);  // ã“ã‚Œã¯å€¤ã®ä¼é”ã®ä»•çµ„ã¿ã®ã¿

// âœ… æ­£è§£: useStateãŒçŠ¶æ…‹ã‚’ä¿æŒã—ã¦ã„ã‚‹
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState('light');  // ã“ã“ã§çŠ¶æ…‹ã‚’ä¿æŒ
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}
```

### æ³¨æ„ç‚¹: Contextã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å•é¡Œ

> **ğŸ“š Context APIã®æ³¨æ„ç‚¹**: Context APIã®è©³ç´°ãªæ³¨æ„ç‚¹ï¼ˆå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®å•é¡Œãªã©ï¼‰ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**Contextã®å€¤ãŒæ›´æ–°ã•ã‚Œã‚‹ã¨ã€ãã®Contextã‚’ä½¿ã£ã¦ã„ã‚‹ï¼ˆæ¶ˆè²»ã—ã¦ã„ã‚‹ï¼‰å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹**ãŸã‚ã€é »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªçŠ¶æ…‹ï¼ˆä¾‹ï¼šã‚¿ã‚¤ãƒãƒ¼ã‚„å…¥åŠ›å€¤ï¼‰ã«ã¯ä¸å‘ãã§ã™ã€‚

```typescript
// âŒ ãƒãƒƒãƒ‰ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹: é »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹çŠ¶æ…‹ã‚’Contextã§ç®¡ç†
// context/TimerContext.tsx
// æ³¨æ„: useStateã¨useEffectã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
export function TimerProvider({ children }: { children: ReactNode }) {
  const [time, setTime] = useState(new Date());
  
  useEffect(() => {
    const interval = setInterval(() => {
      setTime(new Date());  // 1ç§’ã”ã¨ã«æ›´æ–°
    }, 1000);
    return () => clearInterval(interval);
  }, []);
  
  return (
    <TimerContext.Provider value={{ time }}>
      {children}  {/* å•é¡Œ: 1ç§’ã”ã¨ã«å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ */}
    </TimerContext.Provider>
  );
}

// âœ… ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹: é »ç¹ã«æ›´æ–°ã•ã‚Œãªã„çŠ¶æ…‹ã®ã¿Contextã§ç®¡ç†
// context/ThemeContext.tsx
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState('light');  // ã‚ã£ãŸã«æ›´æ–°ã•ã‚Œãªã„
  
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}
```

### ğŸ’¡ ã‚·ãƒ‹ã‚¢ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹

**ã€ŒContextã¯ã€èªè¨¼æƒ…å ±ã€ãƒ†ãƒ¼ãƒã€è¨€èªè¨­å®šãªã©ã€ã‚ã£ãŸã«å¤‰ã‚ã‚‰ãªã„ã€é™çš„ãªå…±æœ‰ãƒ‡ãƒ¼ã‚¿ã€ã«é™å®šã—ã¦ä½¿ã„ã¾ã—ã‚‡ã†ã€‚ã€**

**é©åˆ‡ãªä½¿ç”¨ä¾‹:**
- âœ… èªè¨¼æƒ…å ±ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ï¼‰
- âœ… ãƒ†ãƒ¼ãƒï¼ˆãƒ©ã‚¤ãƒˆ/ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼‰
- âœ… è¨€èªè¨­å®šï¼ˆi18nï¼‰
- âœ… ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æƒ…å ±

**ä¸é©åˆ‡ãªä½¿ç”¨ä¾‹:**
- âŒ ã‚¿ã‚¤ãƒãƒ¼ï¼ˆé »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹ï¼‰
- âŒ ãƒ•ã‚©ãƒ¼ãƒ ã®å…¥åŠ›å€¤ï¼ˆé »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹ï¼‰
- âŒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ï¼ˆé »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹ï¼‰
- âŒ ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆTanStack Queryã‚„SWRã‚’ä½¿ç”¨ã™ã¹ãï¼‰

---

## SWR vs TanStack Query (Server State)

ã“ã‚Œã‚‰ã¯ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã‚‹ãƒ„ãƒ¼ãƒ«ã€ã§ã¯ãªãã€**ã€Œã‚µãƒ¼ãƒãƒ¼ã®çŠ¶æ…‹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«åŒæœŸã•ã›ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã€**ã§ã™ã€‚

### TanStack Queryï¼ˆæ—§React Queryï¼‰ã®å¼·ã¿ï¼ˆSWRã¨ã®æ¯”è¼ƒï¼‰

#### 1. å®£è¨€çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—

**TanStack Queryã®æ€æƒ³:**
ã€Œã„ã¤å–ã‚‹ã‹ã€ã§ã¯ãªãã€Œã“ã®ã‚­ãƒ¼ï¼ˆ`['user', id]`ï¼‰ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã€ã¨å®£è¨€ã™ã‚‹ã ã‘ã§ã™ã€‚

```typescript
// âœ… TanStack Query: å®£è¨€çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—
import { useQuery } from '@tanstack/react-query';

function UserProfile({ userId }: { userId: string }) {
  // ã€Œuserã€ã¨ã€ŒuserIdã€ã®ã‚­ãƒ¼ã§ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã¨å®£è¨€
  const { data: user } = useQuery({
    queryKey: ['user', userId],  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚­ãƒ¼
    queryFn: () => fetchUser(userId),  // ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°
    staleTime: 5 * 60 * 1000,  // 5åˆ†é–“ã¯æ–°é®®
  });
  
  return <div>{user?.name}</div>;
}

// âœ… SWR: åŒæ§˜ã«å®£è¨€çš„
import useSWR from 'swr';

function UserProfile({ userId }: { userId: string }) {
  // ã€Œuserã€ã¨ã€ŒuserIdã€ã®ã‚­ãƒ¼ã§ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã¨å®£è¨€
  const { data: user } = useSWR(`/api/users/${userId}`, fetcher);
  
  return <div>{user?.name}</div>;
}
```

#### 2. è‡ªå‹•å†å–å¾—ï¼ˆWindow Focus Refetchingï¼‰

ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã¦æˆ»ã£ã¦ããŸç¬é–“ã«ã€è£å´ã§ãƒ‡ãƒ¼ã‚¿ã‚’æœ€æ–°ã«ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚ã“ã‚Œã¯SWRã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€TanStack Queryã®æ–¹ãŒç´°ã‹ã„åˆ¶å¾¡ï¼ˆMutationã®æˆåŠŸå¾Œã«ç‰¹å®šã®ã‚­ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãªã©ï¼‰ã«é•·ã‘ã¦ã„ã¾ã™ã€‚

```typescript
// âœ… TanStack Query: ç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';

function UserProfile({ userId }: { userId: string }) {
  const queryClient = useQueryClient();
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
  const { data: user } = useQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId),
    staleTime: 5 * 60 * 1000,
    refetchOnWindowFocus: true,  // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã«å†å–å¾—
  });
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’æ›´æ–°
  const updateUser = useMutation({
    mutationFn: (data: UserData) => updateUser(userId, data),
    onSuccess: () => {
      // æ›´æ–°æˆåŠŸå¾Œã€ç‰¹å®šã®ã‚­ãƒ¼ã‚’ç„¡åŠ¹åŒ–ï¼ˆå†å–å¾—ã‚’ãƒˆãƒªã‚¬ãƒ¼ï¼‰
      queryClient.invalidateQueries({ queryKey: ['user', userId] });
      // ã¾ãŸã¯ã€é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®ã‚­ãƒ¼ã‚’ç„¡åŠ¹åŒ–
      queryClient.invalidateQueries({ queryKey: ['users'] });
    },
  });
  
  return (
    <div>
      <div>{user?.name}</div>
      <button onClick={() => updateUser.mutate({ name: 'æ–°ã—ã„åå‰' })}>
        æ›´æ–°
      </button>
    </div>
  );
}
```

#### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®åˆ¶å¾¡

TanStack Queryã¯ã€ã‚ˆã‚Šç´°ã‹ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®åˆ¶å¾¡ãŒå¯èƒ½ã§ã™ã€‚

```typescript
// âœ… TanStack Query: è©³ç´°ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡
import { useQuery } from '@tanstack/react-query';

function ProductList() {
  const { data: products } = useQuery({
    queryKey: ['products'],
    queryFn: () => fetchProducts(),
    staleTime: 5 * 60 * 1000,  // 5åˆ†é–“ã¯æ–°é®®ã¨ã¿ãªã™
    gcTime: 10 * 60 * 1000,  // 10åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿æŒï¼ˆæ—§cacheTimeï¼‰
    refetchOnMount: true,  // ãƒã‚¦ãƒ³ãƒˆæ™‚ã«å†å–å¾—
    refetchOnWindowFocus: true,  // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã«å†å–å¾—
    refetchOnReconnect: true,  // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†æ¥ç¶šæ™‚ã«å†å–å¾—
  });
  
  return <div>{/* ... */}</div>;
}
```

### æ¯”è¼ƒè¡¨: TanStack Query vs SWR

| æ©Ÿèƒ½ | TanStack Query | SWR |
|------|---------------|-----|
| **å®£è¨€çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—** | âœ… | âœ… |
| **è‡ªå‹•å†å–å¾—** | âœ… | âœ… |
| **ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡** | âœ…ï¼ˆè©³ç´°ï¼‰ | âœ…ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰ |
| **Mutationå¾Œã®ç„¡åŠ¹åŒ–** | âœ…ï¼ˆæŸ”è»Ÿï¼‰ | âœ…ï¼ˆé™å®šçš„ï¼‰ |
| **DevTools** | âœ…ï¼ˆå„ªç§€ï¼‰ | âŒ |
| **ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º** | ç´„13KB | ç´„4KB |
| **å­¦ç¿’ã‚³ã‚¹ãƒˆ** | ä¸­ | ä½ |
| **TypeScriptã‚µãƒãƒ¼ãƒˆ** | âœ…ï¼ˆå„ªç§€ï¼‰ | âœ… |

### ã©ã¡ã‚‰ã‚’é¸ã¶ã¹ãã‹ï¼Ÿ

**TanStack Queryã‚’é¸ã¶ã¹ãå ´åˆ:**
- è¤‡é›‘ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ãŒå¿…è¦
- Mutationã®åˆ¶å¾¡ãŒé‡è¦
- DevToolsã§ãƒ‡ãƒãƒƒã‚°ã—ãŸã„
- å¤§è¦æ¨¡ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

**SWRã‚’é¸ã¶ã¹ãå ´åˆ:**
- ã‚·ãƒ³ãƒ—ãƒ«ã§è»½é‡ãªè§£æ±ºç­–ãŒå¿…è¦
- ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã‚’æœ€å°é™ã«æŠ‘ãˆãŸã„
- å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’ä½ãæŠ‘ãˆãŸã„
- å°ã€œä¸­è¦æ¨¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

---

### çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®é¸æŠåˆ¤æ–­

#### ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ vs ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹

**é‡è¦ãªåŒºåˆ¥:**

```typescript
// ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹: APIã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿
// - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¿…è¦
// - å†å–å¾—ãŒå¿…è¦
// - åŒæœŸãŒå¿…è¦
// â†’ React Query / SWR ãŒé©ã—ã¦ã„ã‚‹

import { useQuery } from '@tanstack/react-query';

function UserProfile({ userId }: { userId: string }) {
  const { data, isLoading, error } = useQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId),
    staleTime: 5 * 60 * 1000,  // 5åˆ†é–“ã¯æ–°é®®
    cacheTime: 10 * 60 * 1000,  // 10åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  });
  
  if (isLoading) return <Loading />;
  if (error) return <Error />;
  return <div>{data.name}</div>;
}

// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹: UIã®çŠ¶æ…‹
// - ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‹é–‰
// - ãƒ•ã‚©ãƒ¼ãƒ ã®å…¥åŠ›å€¤
// - ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªUIçŠ¶æ…‹
// â†’ Zustand / Jotai / Redux ãŒé©ã—ã¦ã„ã‚‹

import { create } from 'zustand';

interface UIStore {
  isModalOpen: boolean;
  openModal: () => void;
  closeModal: () => void;
}

const useUIStore = create<UIStore>((set) => ({
  isModalOpen: false,
  openModal: () => set({ isModalOpen: true }),
  closeModal: () => set({ isModalOpen: false }),
}));
```

#### çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è©³ç´°æ¯”è¼ƒ

**Zustandã®é©ç”¨ç¯„å›²:**

```typescript
// ZustandãŒé©ã—ã¦ã„ã‚‹å ´åˆ:
// 1. ã‚·ãƒ³ãƒ—ãƒ«ãªã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹
// 2. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒä¸è¦
// 3. å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„

import { create } from 'zustand';
import { devtools, persist } from 'zustand/middleware';

interface CartStore {
  items: CartItem[];
  addItem: (item: CartItem) => void;
  removeItem: (id: string) => void;
}

const useCartStore = create<CartStore>()(
  devtools(
    persist(
      (set) => ({
        items: [],
        addItem: (item) => set((state) => ({
          items: [...state.items, item]
        })),
        removeItem: (id) => set((state) => ({
          items: state.items.filter(item => item.id !== id)
        })),
      }),
      { name: 'cart-storage' }  // localStorageã«æ°¸ç¶šåŒ–
    )
  )
);

// ãƒ¡ãƒªãƒƒãƒˆ:
// - ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„
// - ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆãŒå°‘ãªã„
// - TypeScriptã¨ã®çµ±åˆãŒè‰¯ã„

// ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:
// - è¤‡é›‘ãªçŠ¶æ…‹é·ç§»ã«ã¯ä¸å‘ã
// - ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«ãƒ‡ãƒãƒƒã‚°ãŒãªã„
```

**Reduxã®é©ç”¨ç¯„å›²:**

```typescript
// ReduxãŒé©ã—ã¦ã„ã‚‹å ´åˆ:
// 1. è¤‡é›‘ãªçŠ¶æ…‹é·ç§»
// 2. ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«ãƒ‡ãƒãƒƒã‚°ãŒå¿…è¦
// 3. å³æ ¼ãªçŠ¶æ…‹ç®¡ç†ãŒå¿…è¦
// 4. å¤§è¦æ¨¡ãªã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

import { createSlice, configureStore } from '@reduxjs/toolkit';

const cartSlice = createSlice({
  name: 'cart',
  initialState: { items: [] },
  reducers: {
    addItem: (state, action) => {
      state.items.push(action.payload);
    },
    removeItem: (state, action) => {
      state.items = state.items.filter(item => item.id !== action.payload);
    },
  },
});

export const store = configureStore({
  reducer: {
    cart: cartSlice.reducer,
  },
});

// ãƒ¡ãƒªãƒƒãƒˆ:
// - äºˆæ¸¬å¯èƒ½ãªçŠ¶æ…‹ç®¡ç†
// - å„ªç§€ãªãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«
// - ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 

// ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:
// - å­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„
// - ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆãŒå¤šã„
// - å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯éå‰°
```

**Jotaiã®é©ç”¨ç¯„å›²:**

```typescript
// JotaiãŒé©ã—ã¦ã„ã‚‹å ´åˆ:
// 1. ã‚¢ãƒˆãƒŸãƒƒã‚¯ãªçŠ¶æ…‹ç®¡ç†
// 2. ç´°ã‹ã„ç²’åº¦ã§ã®æœ€é©åŒ–ãŒå¿…è¦
// 3. Reactã®æ€æƒ³ã«è¿‘ã„çŠ¶æ…‹ç®¡ç†

import { atom, useAtom } from 'jotai';

// ã‚¢ãƒˆãƒŸãƒƒã‚¯ãªçŠ¶æ…‹
const userAtom = atom<User | null>(null);
const cartAtom = atom<CartItem[]>([]);

// æ´¾ç”ŸçŠ¶æ…‹
const cartCountAtom = atom((get) => get(cartAtom).length);

function CartButton() {
  const [cart] = useAtom(cartAtom);
  const count = useAtomValue(cartCountAtom);  // ã‚«ã‚¦ãƒ³ãƒˆã ã‘ã‚’è³¼èª­
  
  return <button>Cart ({count})</button>;
}

// ãƒ¡ãƒªãƒƒãƒˆ:
// - éå¸¸ã«ç´°ã‹ã„ç²’åº¦ã§ã®æœ€é©åŒ–
// - useStateã«è¿‘ã„æ„Ÿè¦š
// - ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ã§çŠ¶æ…‹ã‚’æ§‹ç¯‰

// ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:
// - è¤‡é›‘ãªçŠ¶æ…‹é·ç§»ã«ã¯ä¸å‘ã
// - ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒå°ã•ã„
```

#### å®Ÿè·µçš„ãªé¸æŠæŒ‡é‡

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦æ¨¡ã«ã‚ˆã‚‹é¸æŠ:**

```typescript
// å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ< 50ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
// â†’ Zustand + React Query
// ç†ç”±: ã‚·ãƒ³ãƒ—ãƒ«ã€å­¦ç¿’ã‚³ã‚¹ãƒˆãŒä½ã„ã€ååˆ†ãªæ©Ÿèƒ½

// ä¸­è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ50-200ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
// â†’ Zustand + React Query + Context API
// ç†ç”±: æ©Ÿèƒ½ã”ã¨ã«çŠ¶æ…‹ã‚’åˆ†é›¢ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ã¯Zustand

// å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ200+ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
// â†’ Redux Toolkit + React Query
// ç†ç”±: å³æ ¼ãªçŠ¶æ…‹ç®¡ç†ã€ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«ãƒ‡ãƒãƒƒã‚°ã€è¤‡é›‘ãªçŠ¶æ…‹é·ç§»
```

**çŠ¶æ…‹ã®ç¨®é¡ã«ã‚ˆã‚‹é¸æŠ:**

```typescript
// ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ â†’ React Query
const { data } = useQuery({
  queryKey: ['users'],
  queryFn: fetchUsers,
});

// UIçŠ¶æ…‹ â†’ Zustand
const useUIStore = create((set) => ({
  isModalOpen: false,
  toggleModal: () => set((state) => ({ isModalOpen: !state.isModalOpen })),
}));

// ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹ â†’ React Hook Formï¼ˆçŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ãªã„ãŒï¼‰
const { register, handleSubmit } = useForm();

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ â†’ Redux / Zustand
const useOrderStore = create((set) => ({
  orders: [],
  createOrder: async (orderData) => {
    const order = await createOrderAPI(orderData);
    set((state) => ({ orders: [...state.orders, order] }));
  },
}));
```

### çŠ¶æ…‹ç®¡ç†ã®ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

#### ã‚ˆãã‚ã‚‹é–“é•ã„

**é–“é•ã„1: ã™ã¹ã¦ã®çŠ¶æ…‹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã«é…ç½®**

```typescript
// æ‚ªã„ä¾‹: ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã«
const useFormStore = create((set) => ({
  inputValue: '',  // å•é¡Œ: 1ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã—ã‹ä½¿ç”¨ã—ãªã„
  setInputValue: (value: string) => set({ inputValue: value }),
}));

// è‰¯ã„ä¾‹: ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¯useStateã‚’ä½¿ç”¨
// æ³¨æ„: useStateã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
function Form() {
  const [inputValue, setInputValue] = useState('');  // ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹
  return <input value={inputValue} onChange={(e) => setInputValue(e.target.value)} />;
}
```

**é–“é•ã„2: ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ç®¡ç†**

```typescript
// æ‚ªã„ä¾‹: Zustandã§ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ã‚’ç®¡ç†
const useUsersStore = create((set) => ({
  users: [],
  fetchUsers: async () => {
    const users = await fetch('/api/users').then(res => res.json());
    set({ users });
  },
}));

// å•é¡Œ:
// - ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ãŒãªã„
// - å†å–å¾—ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘
// - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒä¸ååˆ†

// è‰¯ã„ä¾‹: React Queryã§ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ã‚’ç®¡ç†
const { data: users } = useQuery({
  queryKey: ['users'],
  queryFn: () => fetch('/api/users').then(res => res.json()),
  staleTime: 5 * 60 * 1000,
});
```

**é–“é•ã„3: Props Drillingã‚’éåº¦ã«é¿ã‘ã‚‹**

> **ğŸ“š Context APIã®è©³ç´°**: Context APIã®è©³ç´°ãªä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã€[Reactã‚¬ã‚¤ãƒ‰ã®Context API](/Reactã‚¬ã‚¤ãƒ‰/02_çŠ¶æ…‹ç®¡ç†/01_Context_API/01_Context_API)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

```typescript
// æ‚ªã„ä¾‹: 2-3å±¤ã®Props Drillingã‚’é¿ã‘ã‚‹ãŸã‚ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã‚’ä½¿ç”¨
// è¦ª â†’ å­ â†’ å­« ã®3å±¤ã ã‘ãªã®ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢ã‚’ä½¿ç”¨

// è‰¯ã„ä¾‹: Context APIã§ååˆ†ãªå ´åˆ
// æ³¨æ„: Context APIã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Reactã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„
const UserContext = createContext<User | null>(null);

function App() {
  const [user, setUser] = useState<User | null>(null);
  return (
    <UserContext.Provider value={user}>
      <Layout />
    </UserContext.Provider>
  );
}

// åˆ¤æ–­åŸºæº–:
// - 2-3å±¤ã®Props Drilling â†’ Context API
// - 4å±¤ä»¥ä¸Šã€ã¾ãŸã¯è¤‡æ•°ã®ãƒ–ãƒ©ãƒ³ãƒ â†’ çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
```

### ã¾ã¨ã‚

çŠ¶æ…‹ç®¡ç†ã®æ·±ã„ç†è§£ã«ãŠã„ã¦é‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼š

1. **çŠ¶æ…‹ã®ç¨®é¡ã‚’ç†è§£**: ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ vs ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹
2. **é©åˆ‡ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®é¸æŠ**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦æ¨¡ã¨è¦ä»¶ã«å¿œã˜ã¦
3. **çŠ¶æ…‹ã®é…ç½®åˆ¤æ–­**: ã‚°ãƒ­ãƒ¼ãƒãƒ« vs ãƒ­ãƒ¼ã‚«ãƒ« vs Context
4. **ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã®å›é¿**: éåº¦ãªã‚°ãƒ­ãƒ¼ãƒãƒ«åŒ–ã‚’é¿ã‘ã‚‹

**ã‚·ãƒ‹ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦è€ƒæ…®ã™ã¹ãç‚¹:**

- **çŠ¶æ…‹ã®ã‚¹ã‚³ãƒ¼ãƒ—**: çŠ¶æ…‹ãŒå¿…è¦ãªç¯„å›²ã‚’æ­£ç¢ºã«åˆ¤æ–­
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é¿ã‘ã‚‹
- **ä¿å®ˆæ€§**: é•·æœŸçš„ã«ä¿å®ˆå¯èƒ½ãªçŠ¶æ…‹ç®¡ç†è¨­è¨ˆ
- **ãƒãƒ¼ãƒ ã®åˆæ„**: ãƒãƒ¼ãƒ å…¨ä½“ã§çµ±ä¸€ã•ã‚ŒãŸçŠ¶æ…‹ç®¡ç†æˆ¦ç•¥