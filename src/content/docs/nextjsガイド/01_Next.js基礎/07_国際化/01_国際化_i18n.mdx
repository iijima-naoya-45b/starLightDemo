---
title: "å›½éš›åŒ– (i18n)"
label: "å›½éš›åŒ– (i18n)"
---

## å›½éš›åŒ– (i18n)

å›½éš›åŒ–ï¼ˆi18nï¼‰ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¤‡æ•°ã®è¨€èªã‚„åœ°åŸŸã«å¯¾å¿œã•ã›ã‚‹ãŸã‚ã®æŠ€è¡“ã§ã™ã€‚Next.jsã§ã¯ã€**next-intl**ã‚’ä½¿ç”¨ã—ã¦å›½éš›åŒ–ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚

### ãªãœå›½éš›åŒ–ãŒå¿…è¦ãªã®ã‹

#### å˜ä¸€è¨€èªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èª²é¡Œ

**å•é¡Œã®ã‚ã‚‹å˜ä¸€è¨€èªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³:**

```typescript
// ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆ
export default function HomePage() {
  return (
    <div>
      <h1>ã‚ˆã†ã“ã</h1>
      <p>ã“ã‚Œã¯ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã™</p>
      <button>ãƒ­ã‚°ã‚¤ãƒ³</button>
    </div>
  );
}

// å•é¡Œç‚¹:
// - è‹±èªåœã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ç†è§£ã§ããªã„
// - å¤šè¨€èªå¯¾å¿œãŒå›°é›£
// - ãƒ†ã‚­ã‚¹ãƒˆã®å¤‰æ›´ãŒå›°é›£
```

**å›½éš›åŒ–ã®è§£æ±º:**

```typescript
// ç¿»è¨³ã‚­ãƒ¼ã‚’ä½¿ç”¨
export default function HomePage() {
  const t = useTranslations();
  
  return (
    <div>
      <h1>{t('welcome')}</h1>
      <p>{t('home.description')}</p>
      <button>{t('login')}</button>
    </div>
  );
}

// ãƒ¡ãƒªãƒƒãƒˆ:
// - è¤‡æ•°ã®è¨€èªã«å¯¾å¿œå¯èƒ½
// - ãƒ†ã‚­ã‚¹ãƒˆã®ç®¡ç†ãŒå®¹æ˜“
// - è¨€èªã®åˆ‡ã‚Šæ›¿ãˆãŒç°¡å˜
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
1. **å¤šè¨€èªå¯¾å¿œ**: è¤‡æ•°ã®è¨€èªã¨åœ°åŸŸã«å¯¾å¿œ
2. **ä¿å®ˆæ€§**: ãƒ†ã‚­ã‚¹ãƒˆã®ä¸€å…ƒç®¡ç†
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¨€èªã«åˆã‚ã›ãŸè¡¨ç¤º
4. **SEO**: è¨€èªã”ã¨ã®SEOæœ€é©åŒ–

### next-intlã®è¨­å®š

#### ä¾å­˜é–¢ä¿‚ã®è¿½åŠ 

```bash
npm install next-intl
```

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```typescript
// i18n.ts
import { notFound } from 'next/navigation';
import { getRequestConfig } from 'next-intl/server';

export const locales = ['ja', 'en', 'zh'] as const;
export type Locale = (typeof locales)[number];

export default getRequestConfig(async ({ locale }) => {
  if (!locales.includes(locale as Locale)) {
    notFound();
  }

  return {
    messages: (await import(`./messages/${locale}.json`)).default,
  };
});
```

#### Next.jsè¨­å®šã®æ›´æ–°

```typescript
// next.config.ts
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin('./i18n.ts');

export default withNextIntl({
  // ä»–ã®è¨­å®š
});
```

#### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

**ğŸ“ JSONå½¢å¼ï¼ˆåŸºæœ¬çš„ãªæ–¹æ³•ï¼‰**

**`messages/ja.json`:**

```json
{
  "welcome": "ã‚ˆã†ã“ã",
  "home": {
    "description": "ã“ã‚Œã¯ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã™"
  },
  "login": "ãƒ­ã‚°ã‚¤ãƒ³",
  "user": {
    "greeting": "ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“",
    "items": "{count}å€‹ã®ã‚¢ã‚¤ãƒ†ãƒ "
  }
}
```

**`messages/en.json`:**

```json
{
  "welcome": "Welcome",
  "home": {
    "description": "This is the home page"
  },
  "login": "Login",
  "user": {
    "greeting": "Hello, {name}",
    "items": "{count} items"
  }
}
```

**ğŸš¨ ãƒã‚µã‚«ãƒª2ï¼šJSONã§ã¯ãªãã€ŒYAMLã€ã‚’æ¤œè¨ã™ã¹ã**

å®Ÿå‹™ã§ã¯ç¿»è¨³ãƒ†ã‚­ã‚¹ãƒˆãŒé•·æ–‡ï¼ˆåˆ©ç”¨è¦ç´„ãªã©ï¼‰ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚JSONã ã¨æ”¹è¡Œã®æ‰±ã„ãŒè‹¦ç—›ã§ã™ãŒã€YAMLãªã‚‰ãƒ–ãƒ­ãƒƒã‚¯æ§‹æ–‡ã§ã‚¹ãƒƒã‚­ãƒªæ›¸ã‘ã¾ã™ã€‚

**ãƒ¡ãƒªãƒƒãƒˆ:**
- é•·æ–‡ã®ç®¡ç†ãŒå®¹æ˜“ï¼ˆãƒ–ãƒ­ãƒƒã‚¯æ§‹æ–‡ï¼‰
- å¯èª­æ€§ãŒé«˜ã„
- ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ä»¥å¤–ï¼ˆç¿»è¨³è€…ï¼‰ã‚‚ç·¨é›†ã—ã‚„ã™ã„

**YAMLå½¢å¼ã®è¨­å®š**

```bash
npm install js-yaml
npm install --save-dev @types/js-yaml
```

**`messages/ja.yaml`:**

```yaml
welcome: "ã‚ˆã†ã“ã"
home:
  description: "ã“ã‚Œã¯ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã™"
  terms: |
    åˆ©ç”¨è¦ç´„ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
    
    1. æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯...
    2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯...
    
    è©³ç´°ã«ã¤ã„ã¦ã¯ã€ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚
login: "ãƒ­ã‚°ã‚¤ãƒ³"
user:
  greeting: "ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“"
  items: "{count}å€‹ã®ã‚¢ã‚¤ãƒ†ãƒ "
```

**ã‚«ã‚¹ã‚¿ãƒ ãƒ­ãƒ¼ãƒ€ãƒ¼ã®å®Ÿè£…:**

```typescript
// i18n.ts
import { notFound } from 'next/navigation';
import { getRequestConfig } from 'next-intl/server';
import { readFileSync } from 'fs';
import { join } from 'path';
import yaml from 'js-yaml';

export const locales = ['ja', 'en', 'zh'] as const;
export type Locale = (typeof locales)[number];

async function loadYamlMessages(locale: Locale) {
  const filePath = join(process.cwd(), 'messages', `${locale}.yaml`);
  const fileContents = readFileSync(filePath, 'utf8');
  return yaml.load(fileContents) as Record<string, unknown>;
}

export default getRequestConfig(async ({ locale }) => {
  if (!locales.includes(locale as Locale)) {
    notFound();
  }

  return {
    messages: await loadYamlMessages(locale as Locale),
  };
});
```

**ğŸ’¡ ã‚·ãƒ‹ã‚¢ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹**

ã€Œèª­ã¿ã‚„ã™ã•ã€ã¨ã€Œç®¡ç†ã‚³ã‚¹ãƒˆã€ã‚’è€ƒãˆã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ä»¥å¤–ï¼ˆç¿»è¨³è€…ï¼‰ã‚‚è§¦ã‚‹ãªã‚‰YAMLã‚’æ¨å¥¨ã™ã¹ãã§ã™ã€‚ç‰¹ã«ã€åˆ©ç”¨è¦ç´„ã‚„ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ãªã©ã®é•·æ–‡ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‚ã‚‹å ´åˆã¯ã€YAMLã®æ–¹ãŒã¯ã‚‹ã‹ã«ç®¡ç†ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

---

#### ğŸš¨ ãƒã‚µã‚«ãƒª3ï¼šå‹å®‰å…¨æ€§ãŒçš†ç„¡

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã§ã¯`t('wrong.key')`ã¨ã‚¿ã‚¤ãƒã—ã¦ã‚‚å®Ÿè¡Œæ™‚ã¾ã§ã‚¨ãƒ©ãƒ¼ã«æ°—ã¥ã‘ã¾ã›ã‚“ã€‚next-intlã®Type-safe messagesæ©Ÿèƒ½ã‚’å°å…¥ã—ã€messages/ja.jsonã®æ§‹é€ ã‚’è‡ªå‹•ã§å‹å®šç¾©ã«è½ã¨ã—è¾¼ã‚€è¨­å®šã‚’è¿½è¨˜ã™ã¹ãã§ã™ã€‚

**å‹å®‰å…¨æ€§ã®è¨­å®š**

```typescript
// global.d.tsï¼ˆã¾ãŸã¯å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
import { routing } from './i18n/routing';
import messages from './messages/ja.json';

declare module 'next-intl' {
  interface AppConfig {
    Locale: (typeof routing.locales)[number];
    Messages: typeof messages;
  }
}

// i18n/routing.ts
export const routing = {
  locales: ['ja', 'en', 'zh'] as const,
  defaultLocale: 'ja' as const,
};
```

**tsconfig.jsonã®è¨­å®š:**

```json
{
  "compilerOptions": {
    "resolveJsonModule": true,
    "esModuleInterop": true
  }
}
```

**å‹å®‰å…¨ãªä½¿ç”¨ä¾‹:**

```typescript
// âœ… å‹å®‰å…¨: å­˜åœ¨ã™ã‚‹ã‚­ãƒ¼ã¯è£œå®Œã•ã‚Œã‚‹
const t = useTranslations('user');
t('greeting', { name: 'Taro' }); // âœ… OK
t('items', { count: 5 }); // âœ… OK

// âŒ å‹ã‚¨ãƒ©ãƒ¼: å­˜åœ¨ã—ãªã„ã‚­ãƒ¼ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼
t('wrong.key'); // âŒ å‹ã‚¨ãƒ©ãƒ¼
t('greeting', { wrongParam: 'value' }); // âŒ å‹ã‚¨ãƒ©ãƒ¼

// âœ… å‹å®‰å…¨ãªå¼•æ•°
t('greeting', { name: 'Taro' }); // nameã¯å¿…é ˆ
t('items', { count: 5 }); // countã¯å¿…é ˆ
```

**å‹å®šç¾©ã®è‡ªå‹•ç”Ÿæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰:**

```typescript
// next.config.ts
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin('./i18n.ts', {
  experimental: {
    createMessagesDeclaration: './messages/ja.json'
  }
});

export default withNextIntl({
  // ä»–ã®è¨­å®š
});
```

**æ³¨æ„ç‚¹:**
- TypeScriptã®`resolveJsonModule`ã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ã€å‹å®šç¾©ã‚‚è‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã¾ã™
- YAMLã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€å‹å®‰å…¨æ€§ã®æ©æµã‚’å—ã‘ã«ãã„ãŸã‚ã€JSONã®æ–¹ãŒæ¨å¥¨ã•ã‚Œã¾ã™ï¼ˆãŸã ã—ã€YAMLã‹ã‚‰å‹å®šç¾©ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ï¼‰

### ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®è¨­å®š

```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';
import { locales } from './i18n';

export default createMiddleware({
  locales,
  defaultLocale: 'ja',
  localePrefix: 'as-needed', // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èªã®å ´åˆã¯ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã—
});

export const config = {
  matcher: ['/((?!api|_next|_vercel|.*\\..*).*)'],
};
```

### ãƒšãƒ¼ã‚¸ã§ã®ä½¿ç”¨

#### ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// app/[locale]/page.tsx
import { useTranslations } from 'next-intl';
import { getTranslations } from 'next-intl/server';

export default async function HomePage({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const t = await getTranslations('home');

  return (
    <div>
      <h1>{t('welcome')}</h1>
      <p>{t('description')}</p>
    </div>
  );
}
```

#### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// components/UserGreeting.tsx
'use client';

import { useTranslations } from 'next-intl';

export default function UserGreeting({ name }: { name: string }) {
  const t = useTranslations('user');

  return (
    <div>
      <p>{t('greeting', { name })}</p>
      <p>{t('items', { count: 5 })}</p>
    </div>
  );
}
```

### è¨€èªã®åˆ‡ã‚Šæ›¿ãˆ

```typescript
// components/LanguageSwitcher.tsx
'use client';

import { useLocale } from 'next-intl';
import { useRouter, usePathname } from 'next/navigation';
import { useTransition } from 'react';

export default function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();
  const [isPending, startTransition] = useTransition();

  const switchLocale = (newLocale: string) => {
    startTransition(() => {
      // ãƒ‘ã‚¹ã‹ã‚‰ç¾åœ¨ã®ãƒ­ã‚±ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã€æ–°ã—ã„ãƒ­ã‚±ãƒ¼ãƒ«ã«ç½®ãæ›ãˆ
      const segments = pathname.split('/').filter(Boolean);
      const currentLocaleIndex = segments.findIndex(seg => ['ja', 'en', 'zh'].includes(seg));
      
      if (currentLocaleIndex !== -1) {
        segments[currentLocaleIndex] = newLocale;
      } else {
        segments.unshift(newLocale);
      }
      
      router.push(`/${segments.join('/')}`);
    });
  };

  return (
    <select
      value={locale}
      onChange={(e) => switchLocale(e.target.value)}
      disabled={isPending}
    >
      <option value="ja">æ—¥æœ¬èª</option>
      <option value="en">English</option>
      <option value="zh">ä¸­æ–‡</option>
    </select>
  );
}
```

**å‹•çš„ãªãƒ­ã‚±ãƒ¼ãƒ«ã®å–å¾—:**

```typescript
// useLocaleã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ã¿ä½¿ç”¨å¯èƒ½
'use client';

import { useLocale } from 'next-intl';

export default function MyComponent() {
  const locale = useLocale(); // 'ja' | 'en' | 'zh'
  
  // ãƒ­ã‚±ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦æ¡ä»¶åˆ†å²
  const imagePath = `/images/${locale}/hero.png`;
  
  return <img src={imagePath} alt="Hero" />;
}

// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€paramsã‹ã‚‰å–å¾—
export default async function MyPage({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const imagePath = `/images/${locale}/hero.png`;
  
  return <img src={imagePath} alt="Hero" />;
}
```

### æ—¥ä»˜ã¨æ•°å€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```typescript
// components/FormattedDate.tsx
'use client';

import { useFormatter } from 'next-intl';

export default function FormattedDate({ date }: { date: Date }) {
  const format = useFormatter();

  return (
    <div>
      <p>{format.dateTime(date, { dateStyle: 'long' })}</p>
      <p>{format.number(1234.56, { style: 'currency', currency: 'JPY' })}</p>
      <p>{format.relativeTime(date)}</p>
    </div>
  );
}
```

### å®Ÿè·µçš„ãªä¾‹: å¤šè¨€èªå¯¾å¿œã‚¢ãƒ—ãƒª

```typescript
// app/[locale]/layout.tsx
import { NextIntlClientProvider } from 'next-intl';
import { getMessages } from 'next-intl/server';
import { notFound } from 'next/navigation';
import { locales } from '@/i18n';

export function generateStaticParams() {
  return locales.map((locale) => ({ locale }));
}

export default async function LocaleLayout({
  children,
  params: { locale },
}: {
  children: React.ReactNode;
  params: { locale: string };
}) {
  if (!locales.includes(locale as any)) {
    notFound();
  }

  const messages = await getMessages();

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

### SEOæœ€é©åŒ–ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å›½éš›åŒ–

```typescript
// app/[locale]/layout.tsx
import { getTranslations } from 'next-intl/server';
import { locales } from '@/i18n/routing';

export async function generateMetadata({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const t = await getTranslations({ locale, namespace: 'metadata' });

  return {
    title: t('title'),
    description: t('description'),
    alternates: {
      languages: Object.fromEntries(
        locales.map((loc) => [loc, `/${loc}`])
      ),
    },
  };
}
```

**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ :**

```json
// messages/ja.json
{
  "metadata": {
    "title": "ã‚µã‚¤ãƒˆã‚¿ã‚¤ãƒˆãƒ«",
    "description": "ã‚µã‚¤ãƒˆã®èª¬æ˜æ–‡"
  }
}
```

---

## ğŸ“¸ ã‚¢ã‚»ãƒƒãƒˆï¼ˆç”»åƒãƒ»OGPï¼‰ã®å›½éš›åŒ–

### ç”»åƒã®å›½éš›åŒ–

è¨€èªã”ã¨ã«ç•°ãªã‚‹ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã§ã™ã€‚

#### 1. é™çš„ç”»åƒã®å›½éš›åŒ–

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ :**

```
public/
  images/
    ja/
      hero.png
      logo.svg
    en/
      hero.png
      logo.svg
```

**ä½¿ç”¨ä¾‹:**

```typescript
// app/[locale]/page.tsx
import Image from 'next/image';
import { getTranslations } from 'next-intl/server';

export default async function HomePage({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const t = await getTranslations();
  
  // ãƒ­ã‚±ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ç”»åƒãƒ‘ã‚¹ã‚’ç”Ÿæˆ
  const heroImage = `/images/${locale}/hero.png`;
  const logoImage = `/images/${locale}/logo.svg`;

  return (
    <div>
      <Image src={logoImage} alt={t('logo.alt')} width={200} height={50} />
      <Image src={heroImage} alt={t('hero.alt')} width={1200} height={600} />
    </div>
  );
}
```

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨:**

```typescript
// components/LocalizedImage.tsx
'use client';

import Image from 'next/image';
import { useLocale } from 'next-intl';

interface LocalizedImageProps {
  src: string; // ãƒ­ã‚±ãƒ¼ãƒ«éƒ¨åˆ†ã‚’é™¤ã„ãŸãƒ‘ã‚¹ï¼ˆä¾‹: '/images/hero.png'ï¼‰
  alt: string;
  width: number;
  height: number;
}

export default function LocalizedImage({
  src,
  alt,
  width,
  height,
}: LocalizedImageProps) {
  const locale = useLocale();
  
  // ãƒ‘ã‚¹ã‹ã‚‰æ‹¡å¼µå­ã‚’åˆ†é›¢
  const [basePath, extension] = src.split('.');
  const localizedSrc = `${basePath}/${locale}.${extension}`;

  return (
    <Image
      src={localizedSrc}
      alt={alt}
      width={width}
      height={height}
    />
  );
}

// ä½¿ç”¨ä¾‹
<LocalizedImage
  src="/images/hero.png"
  alt="Hero image"
  width={1200}
  height={600}
/>
```

#### 2. OGPï¼ˆOpen Graphï¼‰ç”»åƒã®å›½éš›åŒ–

Next.js 13+ã®App Routerã§ã¯ã€`opengraph-image.tsx`ã‚’ä½¿ç”¨ã—ã¦å‹•çš„ã«OGPç”»åƒã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

**å‹•çš„OGPç”»åƒã®ç”Ÿæˆ:**

```typescript
// app/[locale]/opengraph-image.tsx
import { ImageResponse } from 'next/og';
import { getTranslations } from 'next-intl/server';

export const runtime = 'edge';
export const alt = 'OG Image';
export const size = {
  width: 1200,
  height: 630,
};

export default async function OpenGraphImage({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const t = await getTranslations({ locale, namespace: 'og' });

  return new ImageResponse(
    (
      <div
        style={{
          fontSize: 60,
          background: 'white',
          width: '100%',
          height: '100%',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
          justifyContent: 'center',
          padding: '40px',
        }}
      >
        <h1>{t('title')}</h1>
        <p>{t('description')}</p>
      </div>
    ),
    {
      ...size,
    }
  );
}
```

**é™çš„OGPç”»åƒã®å›½éš›åŒ–:**

```typescript
// app/[locale]/opengraph-image.tsx
import { ImageResponse } from 'next/og';
import { ImageResponse as StaticImageResponse } from 'next/server';
import { readFileSync } from 'fs';
import { join } from 'path';

export const runtime = 'edge';
export const alt = 'OG Image';
export const size = {
  width: 1200,
  height: 630,
};

export default async function OpenGraphImage({
  params: { locale },
}: {
  params: { locale: string };
}) {
  // ãƒ­ã‚±ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ç”»åƒã‚’èª­ã¿è¾¼ã¿
  const imagePath = join(process.cwd(), 'public', 'og', `${locale}.png`);
  const imageBuffer = readFileSync(imagePath);
  
  return new ImageResponse(imageBuffer, {
    ...size,
  });
}
```

**ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§ã®OGPç”»åƒã®æŒ‡å®š:**

```typescript
// app/[locale]/layout.tsx
import { getTranslations } from 'next-intl/server';

export async function generateMetadata({
  params: { locale },
}: {
  params: { locale: string };
}) {
  const t = await getTranslations({ locale, namespace: 'metadata' });

  return {
    title: t('title'),
    description: t('description'),
    openGraph: {
      title: t('title'),
      description: t('description'),
      images: [
        {
          url: `/og/${locale}.png`, // ã¾ãŸã¯å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸç”»åƒ
          width: 1200,
          height: 630,
          alt: t('og.alt'),
        },
      ],
      locale: locale,
      type: 'website',
    },
    twitter: {
      card: 'summary_large_image',
      title: t('title'),
      description: t('description'),
      images: [`/og/${locale}.png`],
    },
    alternates: {
      languages: {
        ja: '/ja',
        en: '/en',
        zh: '/zh',
      },
    },
  };
}
```

#### 3. ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã®å›½éš›åŒ–

```typescript
// app/[locale]/icon.tsx
import { ImageResponse } from 'next/og';

export const size = {
  width: 32,
  height: 32,
};
export const contentType = 'image/png';

export default async function Icon({
  params: { locale },
}: {
  params: { locale: string };
}) {
  // ãƒ­ã‚±ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ã‚’ç”Ÿæˆ
  return new ImageResponse(
    (
      <div
        style={{
          fontSize: 24,
          background: 'transparent',
          width: '100%',
          height: '100%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
        }}
      >
        {locale.toUpperCase()}
      </div>
    ),
    {
      ...size,
    }
  );
}
```

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ç”»åƒã®å‘½åè¦å‰‡**: ãƒ­ã‚±ãƒ¼ãƒ«ã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†ã‘ã‚‹ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«åã«ãƒ­ã‚±ãƒ¼ãƒ«ã‚’å«ã‚ã‚‹
2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ­ã‚±ãƒ¼ãƒ«ã®ç”»åƒã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ä½¿ç”¨
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å¿…è¦ãªç”»åƒã®ã¿ã‚’èª­ã¿è¾¼ã‚€ï¼ˆNext.jsã®Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ï¼‰
4. **OGPç”»åƒ**: å‹•çš„ç”Ÿæˆã¨é™çš„ç”»åƒã®ä½¿ã„åˆ†ã‘ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨æŸ”è»Ÿæ€§ã®ãƒãƒ©ãƒ³ã‚¹ï¼‰

```typescript
// ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä»˜ãã®ç”»åƒèª­ã¿è¾¼ã¿
function getLocalizedImage(src: string, locale: string, fallbackLocale = 'ja') {
  const localizedSrc = src.replace('{locale}', locale);
  
  // ç”»åƒãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€å­˜åœ¨ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦ï¼‰
  return localizedSrc || src.replace('{locale}', fallbackLocale);
}
```

### ã¾ã¨ã‚

Next.jsã§å›½éš›åŒ–ã‚’å®Ÿè£…ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆï¼š

- **next-intl**: å›½éš›åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«**: è¨€èªã”ã¨ã®ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJSONã¾ãŸã¯YAMLï¼‰
  - **YAML**: é•·æ–‡ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚„ç¿»è¨³è€…ãŒç·¨é›†ã™ã‚‹å ´åˆã«æ¨å¥¨
  - **JSON**: å‹å®‰å…¨æ€§ãŒé«˜ã„ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒç·¨é›†ã™ã‚‹å ´åˆã«æ¨å¥¨
- **å‹å®‰å…¨æ€§**: Type-safe messagesæ©Ÿèƒ½ã§å‹ã‚¨ãƒ©ãƒ¼ã‚’é˜²æ­¢
- **ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢**: è¨€èªã®è‡ªå‹•æ¤œå‡ºã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **æ—¥ä»˜ãƒ»æ•°å€¤ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: åœ°åŸŸã«å¿œã˜ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- **SEOæœ€é©åŒ–**: è¨€èªã”ã¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- **ã‚¢ã‚»ãƒƒãƒˆã®å›½éš›åŒ–**: ç”»åƒã‚„OGPç”»åƒã®å¤šè¨€èªå¯¾å¿œ

**ğŸš¨ é‡è¦ãªæ³¨æ„ç‚¹:**

1. **YAML vs JSON**: é•·æ–‡ã‚„ç¿»è¨³è€…ãŒç·¨é›†ã™ã‚‹å ´åˆã¯YAMLã€å‹å®‰å…¨æ€§ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯JSON
2. **å‹å®‰å…¨æ€§**: Type-safe messagesæ©Ÿèƒ½ã‚’å¿…ãšå°å…¥ã—ã€å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ã‚’é˜²æ­¢
3. **ã‚¢ã‚»ãƒƒãƒˆç®¡ç†**: ç”»åƒã‚„OGPç”»åƒã‚‚å›½éš›åŒ–ã—ã€SEOã‚’æœ€é©åŒ–

å›½éš›åŒ–ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ä¸å¯æ¬ ãªæ©Ÿèƒ½ã§ã™ã€‚é©åˆ‡ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ä¸–ç•Œä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©åˆ‡ãªä½“é¨“ã‚’æä¾›ã§ãã¾ã™ã€‚

